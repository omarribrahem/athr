!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ø¯Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„: Ø£Ø³Ø§Ø³ÙŠØ§Øª Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø© - Ù…Ù†ØµØ© Ø£Ø«Ø±</title>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <style>
        :root {
            --glass-bg: rgba(255,255,255,0.18);
            --glass-border: rgba(255,255,255,0.4);
            --text-color: #1e293b;
            --highlight-color: #0ea5e9;
            --practice-color: #16a34a;
            --translation-color: #8b5cf6;
            --ai-color: #f59e0b;
            --border-radius: 24px;
        }

        @keyframes gradientAnimation { 0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%} }
        @keyframes floatSphere1 { 0%,100%{transform:translateY(0px) rotate(0deg) scale(1)} 50%{transform:translateY(-30px) rotate(180deg) scale(1.05)} }
        @keyframes floatSphere2 { 0%,100%{transform:translateX(0px) translateY(0px) rotate(0deg) scale(1)} 50%{transform:translateX(25px) translateY(-25px) rotate(-180deg) scale(0.95)} }
        @keyframes floatSphere3 { 0%,100%{transform:translateX(0px) translateY(0px) rotate(0deg) scale(1)} 50%{transform:translateX(-20px) translateY(35px) rotate(120deg) scale(1.08)} }
        @keyframes translate-glow { 0%,100%{box-shadow:0 0 15px -5px rgba(139,92,246,0.4),inset 0 2px 0 rgba(255,255,255,0.4);} 50%{box-shadow:0 0 25px 0px rgba(139,92,246,0.6),inset 0 2px 0 rgba(255,255,255,0.6);} }
        @keyframes ai-glow { 0%,100%{box-shadow:0 0 15px -5px rgba(245,158,11,0.4),inset 0 2px 0 rgba(255,255,255,0.4);} 50%{box-shadow:0 0 25px 0px rgba(245,158,11,0.6),inset 0 2px 0 rgba(255,255,255,0.6);} }
        @keyframes spin { from{transform:rotate(0deg)} to{transform:rotate(360deg)} }
        @keyframes pulseGlow { 0%,100%{opacity:0.7; filter:blur(14px);} 50%{opacity:1; filter:blur(20px);} }
        @keyframes typingDots { 0%,20%{opacity:0} 40%{opacity:1} 60%,100%{opacity:0} }

        *{box-sizing:border-box;margin:0;padding:0}
        html{font-size:16px;scroll-behavior:smooth}
        body{
            font-family:'Inter', -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
            background-color:#e0f2fe;color:var(--text-color);line-height:1.8;overflow-x:hidden;position:relative;direction:rtl;
            font-size:clamp(0.9rem,2.5vw,1.05rem);padding:20px clamp(10px,3vw,20px);
        }
        body[dir="ltr"]{direction:ltr}

        .background-gradient,.floating-spheres{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-2}
        .background-gradient{background:linear-gradient(135deg,#e0f2fe 0%,#bae6fd 25%,#fce7f3 75%,#fdf2f8 100%);background-size:400% 400%;animation:gradientAnimation 40s ease infinite}
        .floating-spheres{z-index:-1;pointer-events:none}
        .sphere{position:absolute;border-radius:50%;backdrop-filter:blur(20px);border:2px solid rgba(255,255,255,0.3);box-shadow:0 20px 60px rgba(14,165,233,0.3),inset 0 4px 0 rgba(255,255,255,0.4)}
        .sphere.large{width:clamp(120px,20vw,220px);height:clamp(120px,20vw,220px);top:8%;right:12%;background:radial-gradient(circle,#3b82f6,#1e3a8a);animation:floatSphere1 12s ease-in-out infinite}
        .sphere.medium{width:clamp(80px,15vw,140px);height:clamp(80px,15vw,140px);bottom:20%;left:8%;background:radial-gradient(circle,#0ea5e9,#0369a1);animation:floatSphere2 9s ease-in-out infinite}
        .sphere.small-1{width:clamp(60px,12vw,95px);height:clamp(60px,12vw,95px);top:50%;right:8%;background:radial-gradient(circle,#06b6d4,#0e7490);animation:floatSphere3 6s ease-in-out infinite}

        .fab-button{
            position:fixed;background:rgba(255,255,255,0.1);backdrop-filter:blur(25px);border:2px solid var(--glass-border);border-radius:50px;
            padding:clamp(8px,2vw,12px);cursor:pointer;z-index:1000;display:flex;align-items:center;justify-content:center;
            width:clamp(50px,12vw,60px);height:clamp(50px,12vw,60px);
            transition:all 0.4s cubic-bezier(0.25,0.8,0.25,1);box-shadow:0 8px 25px -10px rgba(0,0,0,0.2),inset 0 2px 0 rgba(255,255,255,0.5)
        }
        .fab-button:hover{width:auto;padding:clamp(8px,2vw,12px) clamp(16px,4vw,22px);transform:translateY(-3px)}
        .fab-button .icon{width:28px;height:28px;flex-shrink:0;transition:transform 0.3s ease}
        .fab-button:hover .icon{transform:scale(0.9)}
        .fab-text{font-size:clamp(0.85rem,2.2vw,1rem);font-weight:600;white-space:nowrap;display:none;margin-left:10px}
        body[dir="ltr"] .fab-text{margin-left:0;margin-right:10px}
        .fab-button:hover .fab-text{display:block}

        .translation-button{top:clamp(20px,5vw,30px);right:clamp(20px,5vw,30px)}
        body[dir="ltr"] .translation-button{right:auto;left:clamp(20px,5vw,30px)}
        .translation-button:hover{border-color:var(--translation-color);background:rgba(139,92,246,0.1);animation:translate-glow 2.5s infinite alternate}
        .translation-button .fab-text{color:var(--translation-color)}

        .ai-chat-button{bottom:clamp(20px,5vw,30px);right:clamp(20px,5vw,30px)}
        body[dir="ltr"] .ai-chat-button{right:auto;left:clamp(20px,5vw,30px)}
        .ai-chat-button:hover{border-color:var(--ai-color);background:rgba(245,158,11,0.1);animation:ai-glow 2.5s infinite alternate}
        .ai-chat-button .fab-text{color:var(--ai-color)}

        .main-content{max-width:1200px;margin:90px auto 0;padding:clamp(20px,5vw,40px)}
        .glassy-card{
            background:var(--glass-bg);border:2px solid var(--glass-border);border-radius:var(--border-radius);
            padding:clamp(20px,5vw,30px);margin-bottom:clamp(25px,5vw,35px);backdrop-filter:blur(25px);
            transition:all 0.4s ease;box-shadow:0 20px 50px rgba(0,0,0,0.1),inset 0 2px 0 rgba(255,255,255,0.5)
        }
        .glassy-card:hover{transform:translateY(-5px) scale(1.01);border-color:rgba(255,255,255,0.7)}

        /* Video Player */
        .video-container{
            position:relative;overflow:hidden;border-radius:var(--border-radius);
            background:var(--glass-bg);backdrop-filter:blur(25px);border:2px solid var(--glass-border);
            box-shadow:0 20px 50px rgba(0,0,0,0.15),inset 0 2px 0 rgba(255,255,255,0.5);
            transition:all 0.4s ease;margin-bottom:clamp(25px,5vw,35px);will-change:transform
        }
        .video-container:hover{transform:translateY(-5px) scale(1.01);border-color:rgba(255,255,255,0.7)}
        .video-container video{width:100%;height:auto;min-height:300px;display:block;background:#000}

        /* Improved Loader (glass ring + glow) */
        .video-loading{
            position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
            width:72px;height:72px;border-radius:50%;
            display:none;z-index:15;
        }
        .video-loading.active{display:block}
        /* ring */
        .video-loading::before{
            content:"";position:absolute;inset:0;border-radius:50%;
            background:conic-gradient(from 0deg, rgba(255,255,255,0.05) 0 30%, var(--highlight-color) 30% 60%, rgba(255,255,255,0.05) 60% 100%);
            -webkit-mask:radial-gradient(farthest-side, transparent calc(100% - 8px), #000 0);
                    mask:radial-gradient(farthest-side, transparent calc(100% - 8px), #000 0);
            animation:spin 1s linear infinite;
            box-shadow:0 8px 25px rgba(14,165,233,0.35), inset 0 2px 4px rgba(255,255,255,0.35);
        }
        /* moving dot */
        .video-loading::after{
            content:"";position:absolute;inset:8px;border-radius:50%;
            background:radial-gradient(circle at 100% 50%, #fff 0 4px, transparent 5px);
            transform-origin:calc(50% - 20px) 50%;
            animation:spin 1s linear infinite;
            filter:drop-shadow(0 0 6px rgba(255,255,255,0.7)) drop-shadow(0 0 14px rgba(14,165,233,0.6));
        }

        /* Error */
        .video-error{
            position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
            color:#fff;text-align:center;z-index:15;display:none;background:rgba(0,0,0,0.8);
            padding:20px;border-radius:12px;border:1px solid rgba(255,255,255,0.2)
        }
        .video-error.active{display:block}

        /* Seek overlay */
        .seek-overlay{
            position:absolute;top:0;left:0;width:100%;height:100%;
            display:flex;justify-content:center;align-items:center;pointer-events:none;opacity:0;
            transition:opacity 0.25s ease-out;color:#fff;font-size:3rem;text-shadow:0 0 10px rgba(0,0,0,0.5);z-index:20
        }
        .seek-overlay.active{opacity:1}

        /* Controls shell */
        .controls-container{
            position:absolute;bottom:1rem;left:50%;transform:translateX(-50%);
            width:95%;padding:0.75rem 1.5rem;background:rgba(255,255,255,0.1);
            backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);
            border-radius:1.5rem;border:1px solid rgba(255,255,255,0.2);
            box-shadow:0 8px 32px rgba(31,38,135,0.37);
            transition:opacity .3s ease,transform .3s ease;opacity:0;z-index:21
        }
        .video-container:hover .controls-container,
        .video-container.paused .controls-container,
        .video-container.show-controls .controls-container{opacity:1}

        /* Progress */
        .progress-bar-container{
            width:100%;height:6px;background:rgba(255,255,255,0.25);border-radius:3px;cursor:pointer;position:relative;direction:ltr !important;margin-bottom:.85rem
        }
        .buffered-bar{position:absolute;top:0;left:0;height:100%;background:rgba(255,255,255,0.5);border-radius:3px;width:0%}
        .progress-bar{height:100%;background:var(--highlight-color);border-radius:3px;width:0%;position:relative;transition:width .08s linear;direction:ltr !important}
        .progress-bar::after{
            content:"";position:absolute;right:-6px;top:50%;transform:translateY(-50%);width:12px;height:12px;background:var(--highlight-color);border-radius:50%;
            box-shadow:0 2px 8px rgba(14,165,233,0.4);transition:transform .15s ease
        }
        .progress-bar-container:hover .progress-bar::after{transform:translateY(-50%) scale(1.15)}

        /* Buttons */
        .control-btn{
            background:rgba(255,255,255,0.22);border:none;color:#fff;font-size:1rem;cursor:pointer;transition:all .2s ease;
            width:2.75rem;height:2.75rem;border-radius:50%;display:flex;align-items:center;justify-content:center
        }
        .control-btn:hover{transform:scale(1.08);background:rgba(255,255,255,0.3);box-shadow:0 4px 15px rgba(14,165,233,0.3)}
        .control-btn:disabled{opacity:.55;cursor:not-allowed;transform:none}

        /* Volume */
        .volume-slider-container{position:relative;direction:ltr !important}
        .volume-slider{
            -webkit-appearance:none;appearance:none;width:90px;height:8px;background:rgba(255,255,255,0.28);border-radius:4px;outline:none;cursor:pointer;direction:ltr !important
        }
        .volume-slider::-webkit-slider-thumb{
            -webkit-appearance:none;appearance:none;width:16px;height:16px;background:var(--highlight-color);border-radius:50%;cursor:pointer;margin-top:-4px;
            box-shadow:0 2px 8px rgba(14,165,233,0.4);transition:transform .15s ease
        }
        .volume-slider::-webkit-slider-thumb:hover{transform:scale(1.15)}
        .volume-slider::-moz-range-thumb{
            width:14px;height:14px;background:var(--highlight-color);border-radius:50%;cursor:pointer;box-shadow:0 2px 8px rgba(14,165,233,0.4);border:none
        }

        /* Speed menu */
        .settings-container{position:relative}
        .speed-controls{
            position:absolute;bottom:3.5rem;right:-1rem;background:rgba(0,0,0,0.8);backdrop-filter:blur(10px);border-radius:1rem;padding:.5rem;
            display:none;flex-direction:column;gap:.35rem;width:110px;border:1px solid rgba(255,255,255,0.2)
        }
        body[dir="ltr"] .speed-controls{right:auto;left:-1rem}
        .speed-controls button{
            color:#fff;background:none;border:none;padding:.5rem;border-radius:.65rem;cursor:pointer;width:100%;text-align:center;transition:all .15s ease
        }
        .speed-controls button:hover,.speed-controls button.active{background:rgba(14,165,233,0.3);transform:scale(1.03)}

        /* Time (organized pill) */
        .time-display{font-family:'Courier New',monospace;font-variant-numeric:tabular-nums;font-size:.95rem;color:#fff}
        .controls-center{
            display:flex;justify-content:center;align-items:center;width:33.333%;
            background:rgba(0,0,0,0.35);border:1px solid rgba(255,255,255,0.2);
            padding:.35rem .75rem;border-radius:.8rem;color:#fff;gap:.35rem
        }

        /* PiP notice */
        .pip-overlay{
            position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
            background:rgba(0,0,0,0.8);color:#fff;padding:10px 20px;border-radius:20px;font-size:.9rem;opacity:0;transition:opacity .25s ease;z-index:25
        }
        .pip-overlay.active{opacity:1}

        .controls-left,.controls-center,.controls-right{display:flex}
        .controls-left{align-items:center;justify-content:flex-start;gap:1rem;width:33.333%}
        .controls-right{align-items:center;justify-content:flex-end;gap:1rem;width:33.333%}
        body[dir="ltr"] .controls-left{justify-content:flex-start}
        body[dir="ltr"] .controls-right{justify-content:flex-end}

        h1,h2,h3,h4,h5{color:#0f172a;text-shadow:0 2px 8px rgba(255,255,255,0.8);font-weight:700}
        h1{font-size:clamp(2rem,6vw,3.2rem);text-align:center;margin-bottom:clamp(20px,4vw,30px);color:#0c4a6e}
        h2{font-size:clamp(1.5rem,5vw,2.5rem);border-bottom:3px solid rgba(14,165,233,0.3);padding-bottom:clamp(10px,2vw,15px);margin-bottom:clamp(20px,4vw,30px)}
        h3{font-size:clamp(1.2rem,4vw,1.8rem);margin-bottom:clamp(15px,3vw,20px)}
        h4{font-size:clamp(1.1rem,3.5vw,1.5rem);margin-bottom:clamp(12px,2.5vw,18px)}
        p,li{color:#475569;margin-bottom:clamp(10px,2vw,12px)}
        strong{color:#1e3a8a}
        ul,ol{padding-right:clamp(20px,4vw,25px);margin-bottom:20px}
        body[dir="ltr"] ul,body[dir="ltr"] ol{padding-right:0;padding-left:clamp(20px,4vw,25px)}
        .concept-card{background:rgba(255,255,255,0.15);border:2px solid rgba(255,255,255,0.2);border-radius:20px;padding:25px;margin:20px 0;backdrop-filter:blur(20px);transition:.4s}
        .concept-card:hover{transform:translateY(-5px);border-color:rgba(255,255,255,0.4);background:rgba(255,255,255,0.2)}
        .equation-box{background:linear-gradient(135deg,rgba(14,165,233,0.1),rgba(59,130,246,0.1));border:2px solid rgba(14,165,233,0.3);border-radius:16px;padding:20px;margin:20px 0;text-align:center;font-size:1.4rem;font-weight:bold;color:#0c4a6e}

        .ai-chat-modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.3);backdrop-filter:blur(10px);z-index:2000;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity .3s ease}
        .ai-chat-modal.visible{opacity:1;pointer-events:auto}
        .ai-chat-container{background:var(--glass-bg);border:2px solid var(--glass-border);border-radius:var(--border-radius);width:90%;max-width:600px;height:80%;max-height:700px;box-shadow:0 20px 60px rgba(0,0,0,0.2);display:flex;flex-direction:column;transform:scale(0.95);transition:transform .3s ease;backdrop-filter:blur(25px)}
        .ai-chat-modal.visible .ai-chat-container{transform:scale(1)}
        .ai-chat-header{padding:15px 20px;border-bottom:2px solid var(--glass-border);display:flex;justify-content:space-between;align-items:center}
        .ai-chat-header h3{color:#0f172a;margin:0;font-size:clamp(1.1rem,4vw,1.3rem)}
        .ai-chat-close-btn{background:none;border:none;font-size:2rem;cursor:pointer;color:#334155;transition:.2s}
        .ai-chat-close-btn:hover{color:var(--ai-color)}
        .ai-chat-messages{flex-grow:1;padding:20px;overflow-y:auto;display:flex;flex-direction:column;gap:15px}
        .chat-message{max-width:85%;padding:10px 15px;border-radius:18px;line-height:1.6}
        .user-message{background:rgba(14,165,233,0.2);color:#0c4a6e;border-bottom-right-radius:4px;align-self:flex-end}
        body[dir="ltr"] .user-message{border-bottom-left-radius:4px;border-bottom-right-radius:18px;align-self:flex-start}
        .ai-message{background:rgba(245,158,11,0.15);color:#78350f;border-bottom-left-radius:4px;align-self:flex-start}
        body[dir="ltr"] .ai-message{border-bottom-right-radius:4px;border-bottom-left-radius:18px;align-self:flex-end}
        .chat-message strong{color:#1e3a8a;font-weight:700}
        .chat-message ul{margin:8px 0;padding-right:20px}
        body[dir="ltr"] .chat-message ul{padding-right:0;padding-left:20px}
        .chat-message li{margin-bottom:4px}
        .typing-indicator{background:rgba(245,158,11,0.15)!important;color:#9ca3af!important;font-style:italic}
        .dot{animation:typingDots 1.5s infinite;font-size:1.2em;color:var(--ai-color)!important}
        .dot:nth-child(2){animation-delay:.3s}
        .dot:nth-child(3){animation-delay:.6s}
        .ai-chat-input-area{padding:15px 20px;border-top:2px solid var(--glass-border);display:flex;gap:10px}
        #ai-chat-input{flex-grow:1;border:2px solid var(--glass-border);background:rgba(255,255,255,0.3);border-radius:50px;padding:10px 18px;font-size:1rem;color:#1e293b;outline:none;transition:border-color .3s,box-shadow .3s}
        #ai-chat-input:focus{border-color:var(--ai-color);box-shadow:0 0 10px rgba(245,158,11,0.3)}
        #ai-chat-input:disabled{opacity:.6;cursor:not-allowed}
        #ai-chat-send-btn{background-color:var(--ai-color);border:none;border-radius:50%;width:48px;height:48px;flex-shrink:0;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background-color .3s,transform .2s,opacity .3s}
        #ai-chat-send-btn:hover:not(:disabled){background-color:#fbbf24;transform:scale(1.05)}
        #ai-chat-send-btn:disabled{opacity:.6;cursor:not-allowed;transform:none}
        #ai-chat-send-btn svg{width:24px;height:24px;color:#fff}
        .hidden{display:none !important}

        @media (max-width:768px){
            .controls-container{width:98%;padding:.55rem 1rem}
            .control-btn{width:2.25rem;height:2.25rem;font-size:.9rem}
            .volume-slider{width:70px}
            .controls-left,.controls-center,.controls-right{width:auto;flex:1}
        }

        @media (prefers-reduced-motion:reduce){
            *{animation-duration:.01ms !important;animation-iteration-count:1 !important;transition-duration:.01ms !important}
        }
    </style>
</head>
<body>
    <div class="background-gradient"></div>
    <div class="floating-spheres">
        <div class="sphere large"></div>
        <div class="sphere medium"></div>
        <div class="sphere small-1"></div>
    </div>

    <button class="fab-button translation-button" id="translationButton">
        <svg class="icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2.25 12C2.25 17.3848 6.61522 21.75 12 21.75C17.3848 21.75 21.75 17.3848 21.75 12C21.75 6.61522 17.3848 2.25 12 2.25C9.36657 2.25 6.94277 3.22321 5.16629 4.83371M12.75 2.25V7.5M12.75 7.5H18M12.75 7.5L5.16629 4.83371M11.25 21.75V16.5M11.25 16.5H6M11.25 16.5L18.8337 19.1663M5.16629 4.83371C3.22321 6.94277 2.25 9.36657 2.25 12M2.25 12C2.25 14.6334 3.22321 17.0572 4.83371 18.8337M18.8337 19.1663C20.7768 17.0572 21.75 14.6334 21.75 12M18.8337 4.83371C17.0572 3.22321 14.6334 2.25 12 2.25" stroke="#8b5cf6" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
        <span class="fab-text">ØªØ±Ø¬Ù…Ø©</span>
    </button>

    <button class="fab-button ai-chat-button" id="aiChatButton">
        <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="color:#f59e0b;"><path d="M12 8V4H8"/><rect x="4" y="12" width="16" height="8" rx="2"/><path d="M2 14h2"/><path d="M20 14h2"/><path d="M15 13v-2a3 3 0 0 0-3-3H6a3 3 0 0 0-3 3v2"/></svg>
        <span class="fab-text">Ø£Ø«Ø± AI</span>
    </button>

    <main class="main-content">
        <div id="arabicContent">
            <section class="glassy-card">
                <h1>Ø¯Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„: Ø£Ø³Ø§Ø³ÙŠØ§Øª Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©</h1>
                <p style="text-align:center;font-size:1.1rem;color:#475569;">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ Ø£Ø­Ù…Ø¯ØŒ Ø£Ù†Ø§ "Ø£Ø«Ø± AI" Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù…Ù† Ù…Ù†ØµØ© "Ø£Ø«Ø±"</p>
            </section>

            <section class="glassy-card">
                <h2>ğŸ¥ Ø´Ø±Ø­ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø© Ø¨Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</h2>
                <div id="videoPlayer" class="video-container">
                    <video id="video" crossOrigin="anonymous" preload="metadata" aria-label="ÙÙŠØ¯ÙŠÙˆ Ø´Ø±Ø­ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø©">
                        <source src="https://streamable.com/72g2mn" type="video/mp4" />
                        Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ.
                    </video>

                    <div id="videoLoading" class="video-loading"></div>

                    <div id="videoError" class="video-error">
                        <i class="fas fa-exclamation-triangle" style="font-size:2rem;margin-bottom:10px;"></i>
                        <p>Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</p>
                        <button onclick="location.reload()" style="background:var(--highlight-color);border:none;color:#fff;padding:8px 16px;border-radius:20px;margin-top:10px;cursor:pointer;">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©</button>
                    </div>

                    <div id="pipOverlay" class="pip-overlay">Picture-in-Picture Ù…ØªØ§Ø­</div>
                    <div id="seekOverlay" class="seek-overlay"></div>

                    <div class="controls-container">
                        <div class="progress-bar-container" id="progressBarContainer">
                            <div class="buffered-bar" id="bufferedBar"></div>
                            <div class="progress-bar" id="progressBar"></div>
                        </div>

                        <div style="display:flex;align-items:center;justify-content:space-between;color:#fff;">
                            <div class="controls-left">
                                <button id="playPauseBtn" class="control-btn" aria-label="ØªØ´ØºÙŠÙ„"><i class="fas fa-play"></i></button>
                                <div style="display:flex;align-items:center;gap:.5rem;">
                                    <button id="volumeBtn" class="control-btn" aria-label="ÙƒØªÙ… Ø§Ù„ØµÙˆØª"><i class="fas fa-volume-up"></i></button>
                                    <div class="volume-slider-container">
                                        <input type="range" id="volumeSlider" class="volume-slider" min="0" max="1" step="0.01" value="1" aria-label="Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµÙˆØª" />
                                    </div>
                                </div>
                            </div>

                            <div class="controls-center">
                                <span id="currentTime" class="time-display">00:00</span>
                                <span>/</span>
                                <span id="duration" class="time-display">--:--</span>
                            </div>

                            <div class="controls-right">
                                <button id="pipBtn" class="control-btn" aria-label="ØµÙˆØ±Ø© ÙÙŠ ØµÙˆØ±Ø©" style="display:none;"><i class="fas fa-external-link-alt"></i></button>
                                <div class="settings-container">
                                    <button id="settingsBtn" class="control-btn" aria-label="Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª"><i class="fas fa-cog"></i></button>
                                    <div id="speedControls" class="speed-controls">
                                        <button data-speed="0.5">0.5x</button>
                                        <button data-speed="0.75">0.75x</button>
                                        <button data-speed="1" class="active">Ø¹Ø§Ø¯ÙŠ</button>
                                        <button data-speed="1.25">1.25x</button>
                                        <button data-speed="1.5">1.5x</button>
                                        <button data-speed="2">2x</button>
                                    </div>
                                </div>
                                <button id="fullscreenBtn" class="control-btn" aria-label="Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©"><i class="fas fa-expand"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="glassy-card">
                <h2>ğŸ¯ Ø²Ø¨Ø¯Ø© Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø©</h2>
                <div class="concept-card">
                    <p><strong>Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ù„Ù„Ù…Ø­Ø§Ø³Ø¨Ø©</strong> Ù‡Ùˆ ØªÙˆÙÙŠØ± Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…Ø§Ù„ÙŠØ© Ù…ÙÙŠØ¯Ø© Ø¹Ù† Ù…Ù†Ø¸Ù…Ø© Ù…Ø¹ÙŠÙ†Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ù‡ØªÙ…ÙŠÙ† Ù„Ø§ØªØ®Ø§Ø° Ù‚Ø±Ø§Ø±Ø§Øª Ù…Ø¯Ø±ÙˆØ³Ø©ØŒ ÙˆØ°Ù„Ùƒ Ø¹Ø¨Ø± Ù†Ø¸Ø§Ù… Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙŠØ­Ø¯Ø¯ ÙˆÙŠØ³Ø¬Ù„ ÙˆÙŠÙÙˆØµÙ‘Ù„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯ÙŠØ© Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ù…Ù†Ø´Ø£Ø©.</p>
                </div>
            </section>

            <section class="glassy-card">
                <h2>ğŸ“š Ø§Ù„Ù…ÙØ§Ù‡ÙŠÙ… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© (80% ØªØ±ÙƒÙŠØ²)</h2>
                <div class="concept-card">
                    <h4>Ø´Ø±Ø­ Ù…ÙÙ‡ÙˆÙ…: ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©</h4>
                    <p><strong>Ø£ØµÙ„ Ø§Ù„ÙÙƒØ±Ø© (ÙƒØ£Ù† ØµØ§Ø­Ø¨Ùƒ Ø¨ÙŠØ´Ø±Ø­Ù‡Ø§Ù„Ùƒ):</strong></p>
                    <p>Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø© Ù‡ÙŠ Ù†Ø¸Ø§Ù… Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù„ØªØ­Ø¯ÙŠØ¯ ÙˆØªØ³Ø¬ÙŠÙ„ ÙˆØªÙˆØµÙŠÙ„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯ÙŠØ©. ØªØ®ÙŠÙ„ Ø£Ù†Ùƒ ØªØ¯ÙŠØ± Ù…Ø­Ù„ ØµØºÙŠØ±ØŒ ÙˆØ§Ù„Ù…Ø­Ø§Ø³Ø¨Ø© Ù‡ÙŠ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù…Ù†Ø¸Ù…Ø© Ù„ØªØªØ¨Ø¹ ÙƒÙ„ Ù…Ø§ ÙŠØ¯Ø®Ù„ ÙˆÙŠØ®Ø±Ø¬ Ù…Ù† Ø§Ù„Ù…Ø­Ù„ Ù…Ø§Ù„ÙŠØ§Ù‹.</p>
                </div>
            </section>
        </div>

        <div id="englishContent" class="hidden">
            <section class="glassy-card">
                <h1>Comprehensive Guide: Accounting Fundamentals</h1>
                <p style="text-align:center;font-size:1.1rem;color:#475569;">Welcome Ahmed, I am your "Athr AI" from "Athr" platform</p>
            </section>

            <section class="glassy-card">
                <h2>ğŸ¥ Video Lecture</h2>
                <div id="videoPlayerEn" class="video-container">
                    <video id="videoEn" crossOrigin="anonymous" preload="metadata" aria-label="Video lecture explanation">
                        <source src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" type="video/mp4" />
                        Your browser does not support the video tag.
                    </video>

                    <div id="videoLoadingEn" class="video-loading"></div>

                    <div id="videoErrorEn" class="video-error">
                        <i class="fas fa-exclamation-triangle" style="font-size:2rem;margin-bottom:10px;"></i>
                        <p>Video loading error occurred</p>
                        <button onclick="location.reload()" style="background:var(--highlight-color);border:none;color:#fff;padding:8px 16px;border-radius:20px;margin-top:10px;cursor:pointer;">Retry</button>
                    </div>

                    <div id="pipOverlayEn" class="pip-overlay">Picture-in-Picture Available</div>
                    <div id="seekOverlayEn" class="seek-overlay"></div>

                    <div class="controls-container">
                        <div class="progress-bar-container" id="progressBarContainerEn">
                            <div class="buffered-bar" id="bufferedBarEn"></div>
                            <div class="progress-bar" id="progressBarEn"></div>
                        </div>

                        <div style="display:flex;align-items:center;justify-content:space-between;color:#fff;">
                            <div class="controls-left">
                                <button id="playPauseBtnEn" class="control-btn" aria-label="Play"><i class="fas fa-play"></i></button>
                                <div style="display:flex;align-items:center;gap:.5rem;">
                                    <button id="volumeBtnEn" class="control-btn" aria-label="Mute"><i class="fas fa-volume-up"></i></button>
                                    <div class="volume-slider-container">
                                        <input type="range" id="volumeSliderEn" class="volume-slider" min="0" max="1" step="0.01" value="1" aria-label="Volume" />
                                    </div>
                                </div>
                            </div>

                            <div class="controls-center">
                                <span id="currentTimeEn" class="time-display">00:00</span>
                                <span>/</span>
                                <span id="durationEn" class="time-display">--:--</span>
                            </div>

                            <div class="controls-right">
                                <button id="pipBtnEn" class="control-btn" aria-label="Picture in Picture" style="display:none;"><i class="fas fa-external-link-alt"></i></button>
                                <div class="settings-container">
                                    <button id="settingsBtnEn" class="control-btn" aria-label="Settings"><i class="fas fa-cog"></i></button>
                                    <div id="speedControlsEn" class="speed-controls">
                                        <button data-speed="0.5">0.5x</button>
                                        <button data-speed="0.75">0.75x</button>
                                        <button data-speed="1" class="active">Normal</button>
                                        <button data-speed="1.25">1.25x</button>
                                        <button data-speed="1.5">1.5x</button>
                                        <button data-speed="2">2x</button>
                                    </div>
                                </div>
                                <button id="fullscreenBtnEn" class="control-btn" aria-label="Fullscreen"><i class="fas fa-expand"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="glassy-card">
                <h2>ğŸ¯ Lecture Summary</h2>
                <div class="concept-card">
                    <p><strong>The main objective of accounting</strong> is to provide useful financial information about a specific organization to interested users for making informed decisions, through an information system that identifies, records, and communicates the economic events of the entity.</p>
                </div>
            </section>
        </div>
    </main>

    <div class="ai-chat-modal" id="aiChatModal">
        <div class="ai-chat-container">
            <div class="ai-chat-header">
                <h3 id="ai-chat-title">Ø§Ø³Ø£Ù„ Ø£Ø«Ø± AI</h3>
                <button class="ai-chat-close-btn" id="aiChatCloseBtn">&times;</button>
            </div>
            <div class="ai-chat-messages" id="aiChatMessages"></div>
            <div class="ai-chat-input-area">
                <input type="text" id="ai-chat-input" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§..." />
                <button id="ai-chat-send-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
                </button>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function () {
        const translationButton = document.getElementById('translationButton');
        const translationText = translationButton.querySelector('.fab-text');
        const arabicContent = document.getElementById('arabicContent');
        const englishContent = document.getElementById('englishContent');
        const html = document.documentElement;
        const body = document.body;
        let isArabic = true;

        // Arabic player refs
        const videoPlayer = document.getElementById('videoPlayer');
        const video = document.getElementById('video');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const progressBarContainer = document.getElementById('progressBarContainer');
        const progressBar = document.getElementById('progressBar');
        const bufferedBar = document.getElementById('bufferedBar');
        const currentTimeEl = document.getElementById('currentTime');
        const durationEl = document.getElementById('duration');
        const volumeBtn = document.getElementById('volumeBtn');
        const volumeSlider = document.getElementById('volumeSlider');
        const fullscreenBtn = document.getElementById('fullscreenBtn');
        const settingsBtn = document.getElementById('settingsBtn');
        const speedControls = document.getElementById('speedControls');
        const seekOverlay = document.getElementById('seekOverlay');
        const videoLoading = document.getElementById('videoLoading');
        const videoError = document.getElementById('videoError');
        const pipBtn = document.getElementById('pipBtn');
        const pipOverlay = document.getElementById('pipOverlay');

        // English player refs
        const videoPlayerEn = document.getElementById('videoPlayerEn');
        const videoEn = document.getElementById('videoEn');
        const playPauseBtnEn = document.getElementById('playPauseBtnEn');
        const progressBarContainerEn = document.getElementById('progressBarContainerEn');
        const progressBarEn = document.getElementById('progressBarEn');
        const bufferedBarEn = document.getElementById('bufferedBarEn');
        const currentTimeElEn = document.getElementById('currentTimeEn');
        const durationElEn = document.getElementById('durationEn');
        const volumeBtnEn = document.getElementById('volumeBtnEn');
        const volumeSliderEn = document.getElementById('volumeSliderEn');
        const fullscreenBtnEn = document.getElementById('fullscreenBtnEn');
        const settingsBtnEn = document.getElementById('settingsBtnEn');
        const speedControlsEn = document.getElementById('speedControlsEn');
        const seekOverlayEn = document.getElementById('seekOverlayEn');
        const videoLoadingEn = document.getElementById('videoLoadingEn');
        const videoErrorEn = document.getElementById('videoErrorEn');
        const pipBtnEn = document.getElementById('pipBtnEn');
        const pipOverlayEn = document.getElementById('pipOverlayEn');

        const aiChatButton = document.getElementById('aiChatButton');
        const aiChatModal = document.getElementById('aiChatModal');
        const aiChatCloseBtn = document.getElementById('aiChatCloseBtn');
        const aiChatMessages = document.getElementById('aiChatMessages');
        const aiChatInput = document.getElementById('ai-chat-input');
        const aiChatSendBtn = document.getElementById('ai-chat-send-btn');
        const aiChatTitle = document.getElementById('ai-chat-title');
        const aiChatButtonText = aiChatButton.querySelector('.fab-text');

        let lastTap = 0;
        let controlsTimeout;

        function createVideoPlayer(videoEl, containerEl, controls) {
            if (!videoEl || !containerEl || !controls) return;
            const {
                playPauseBtn, progressBarContainer, progressBar, bufferedBar, currentTimeEl, durationEl,
                volumeBtn, volumeSlider, fullscreenBtn, settingsBtn, speedControls, seekOverlay,
                videoLoading, videoError, pipBtn, pipOverlay
            } = controls;

            let isDragging = false;
            let wasPlayingBeforeSeeking = false;

            function showError() {
                hideLoading();
                videoError.classList.add('active');
            }
            function hideError() { videoError.classList.remove('active'); }
            function showLoading() { videoLoading.classList.add('active'); hideError(); }
            function hideLoading() { videoLoading.classList.remove('active'); }

            // Loader hooks
            videoEl.addEventListener('loadstart', showLoading);
            videoEl.addEventListener('stalled', showLoading);
            videoEl.addEventListener('waiting', showLoading);
            videoEl.addEventListener('canplay', hideLoading);
            videoEl.addEventListener('canplaythrough', hideLoading);
            videoEl.addEventListener('error', showError);

            // PiP
            if (document.pictureInPictureEnabled && pipBtn) {
                pipBtn.style.display = 'flex';
                pipBtn.addEventListener('click', async () => {
                    try {
                        if (document.pictureInPictureElement) {
                            await document.exitPictureInPicture();
                        } else {
                            await videoEl.requestPictureInPicture();
                            showNotification(isArabic ? 'ØªÙ… ØªÙØ¹ÙŠÙ„ ØµÙˆØ±Ø© Ø¯Ø§Ø®Ù„ ØµÙˆØ±Ø©' : 'Picture-in-Picture enabled', pipOverlay);
                        }
                    } catch (e) {}
                });
            }

            // Play/Pause
            function togglePlay() {
                if (videoEl.paused) {
                    const p = videoEl.play();
                    if (p && p.catch) p.catch(() => {});
                } else {
                    videoEl.pause();
                }
            }
            playPauseBtn.addEventListener('click', togglePlay);
            videoEl.addEventListener('play', () => {
                playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
                playPauseBtn.setAttribute('aria-label', isArabic ? 'Ø¥ÙŠÙ‚Ø§Ù' : 'Pause');
                containerEl.classList.remove('paused');
                hideLoading();
            });
            videoEl.addEventListener('pause', () => {
                playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
                playPauseBtn.setAttribute('aria-label', isArabic ? 'ØªØ´ØºÙŠÙ„' : 'Play');
                containerEl.classList.add('paused');
            });

            // Time + progress
            function formatTime(seconds) {
                if (isNaN(seconds) || !isFinite(seconds)) return '--:--';
                const hrs = Math.floor(seconds / 3600);
                const mins = Math.floor((seconds % 3600) / 60);
                const secs = Math.floor(seconds % 60);
                if (hrs > 0) {
                    return `${hrs.toString().padStart(2,'0')}:${mins.toString().padStart(2,'0')}:${secs.toString().padStart(2,'0')}`;
                }
                return `${mins.toString().padStart(2,'0')}:${secs.toString().padStart(2,'0')}`;
            }
            function updateTimes() {
                currentTimeEl.textContent = formatTime(videoEl.currentTime);
                durationEl.textContent = formatTime(videoEl.duration);
            }

            videoEl.addEventListener('loadedmetadata', () => {
                updateTimes();
                containerEl.classList.add('paused');
                hideLoading();
            });
            videoEl.addEventListener('durationchange', updateTimes);
            videoEl.addEventListener('timeupdate', () => {
                if (!isDragging) {
                    const progress = videoEl.duration ? (videoEl.currentTime / videoEl.duration) * 100 : 0;
                    progressBar.style.width = `${progress}%`;
                    currentTimeEl.textContent = formatTime(videoEl.currentTime);
                }
            });
            videoEl.addEventListener('emptied', () => {
                currentTimeEl.textContent = '00:00';
                durationEl.textContent = '--:--';
                progressBar.style.width = '0%';
            });

            // Buffer bar
            videoEl.addEventListener('progress', () => {
                try {
                    if (videoEl.buffered.length > 0 && isFinite(videoEl.duration) && videoEl.duration > 0) {
                        const end = videoEl.buffered.end(videoEl.buffered.length - 1);
                        bufferedBar.style.width = `${(end / videoEl.duration) * 100}%`;
                    }
                } catch {}
            });

            // Seek
            let isMouseDown = false;
            function handleSeek(e) {
                const rect = progressBarContainer.getBoundingClientRect();
                const clickX = e.clientX - rect.left;
                const width = rect.width;
                const seekPercent = Math.max(0, Math.min(1, clickX / width));
                const newTime = seekPercent * (isFinite(videoEl.duration) ? videoEl.duration : 0);
                if (!isNaN(newTime)) {
                    videoEl.currentTime = newTime;
                    progressBar.style.width = `${seekPercent * 100}%`;
                    currentTimeEl.textContent = formatTime(newTime);
                }
            }
            progressBarContainer.addEventListener('mousedown', (e) => {
                isMouseDown = true; isDragging = true;
                wasPlayingBeforeSeeking = !videoEl.paused;
                videoEl.pause();
                handleSeek(e);
            });
            document.addEventListener('mousemove', (e) => { if (isMouseDown) handleSeek(e); });
            document.addEventListener('mouseup', () => {
                if (isMouseDown) {
                    isMouseDown = false; isDragging = false;
                    if (wasPlayingBeforeSeeking) videoEl.play();
                }
            });

            // Volume
            function updateVolumeIcon() {
                const v = videoEl.volume;
                if (videoEl.muted || v === 0) {
                    volumeBtn.innerHTML = '<i class="fas fa-volume-mute"></i>';
                    volumeBtn.setAttribute('aria-label', isArabic ? 'Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ÙƒØªÙ…' : 'Unmute');
                } else if (v < 0.5) {
                    volumeBtn.innerHTML = '<i class="fas fa-volume-down"></i>';
                    volumeBtn.setAttribute('aria-label', isArabic ? 'ÙƒØªÙ… Ø§Ù„ØµÙˆØª' : 'Mute');
                } else {
                    volumeBtn.innerHTML = '<i class="fas fa-volume-up"></i>';
                    volumeBtn.setAttribute('aria-label', isArabic ? 'ÙƒØªÙ… Ø§Ù„ØµÙˆØª' : 'Mute');
                }
            }
            function updateVolumeSliderVisual() {
                const percentage = parseFloat(volumeSlider.value) * 100;
                volumeSlider.style.background = `linear-gradient(to right, #0ea5e9 ${percentage}%, rgba(255,255,255,0.28) ${percentage}%)`;
            }
            function handleVolumeChange() {
                const v = parseFloat(volumeSlider.value);
                videoEl.volume = v;
                videoEl.muted = v === 0;
                updateVolumeIcon();
                updateVolumeSliderVisual();
                localStorage.setItem('videoVolume', v);
            }
            volumeSlider.addEventListener('input', handleVolumeChange);
            volumeBtn.addEventListener('click', () => {
                if (videoEl.muted || videoEl.volume === 0) {
                    const saved = volumeSlider.getAttribute('data-volume') || '1';
                    videoEl.muted = false;
                    volumeSlider.value = saved;
                    videoEl.volume = parseFloat(saved);
                } else {
                    volumeSlider.setAttribute('data-volume', volumeSlider.value);
                    videoEl.muted = true;
                    volumeSlider.value = 0;
                }
                updateVolumeIcon();
                updateVolumeSliderVisual();
            });

            // Fullscreen
            function toggleFullscreen() {
                if (!document.fullscreenElement) {
                    (containerEl.requestFullscreen?.() || containerEl.webkitRequestFullscreen?.() || containerEl.msRequestFullscreen?.())?.catch?.(()=>{});
                } else {
                    (document.exitFullscreen?.() || document.webkitExitFullscreen?.() || document.msExitFullscreen?.())?.call(document);
                }
            }
            fullscreenBtn.addEventListener('click', toggleFullscreen);

            document.addEventListener('fullscreenchange', updateFullscreenButtons);
            document.addEventListener('webkitfullscreenchange', updateFullscreenButtons);
            document.addEventListener('msfullscreenchange', updateFullscreenButtons);
            function updateFullscreenButtons() {
                const isFs = document.fullscreenElement || document.webkitFullscreenElement || document.msFullscreenElement;
                [fullscreenBtn].filter(Boolean).forEach(btn => {
                    btn.innerHTML = isFs ? '<i class="fas fa-compress"></i>' : '<i class="fas fa-expand"></i>';
                    btn.setAttribute('aria-label', isFs ? (isArabic ? 'Ø®Ø±ÙˆØ¬ Ù…Ù† Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©' : 'Exit Fullscreen') : (isArabic ? 'Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©' : 'Enter Fullscreen'));
                });
                [fullscreenBtnEn].filter(Boolean).forEach(btn => {
                    btn.innerHTML = isFs ? '<i class="fas fa-compress"></i>' : '<i class="fas fa-expand"></i>';
                    btn.setAttribute('aria-label', isFs ? (isArabic ? 'Ø®Ø±ÙˆØ¬ Ù…Ù† Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©' : 'Exit Fullscreen') : (isArabic ? 'Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©' : 'Enter Fullscreen'));
                });
            }

            // Speed
            settingsBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                speedControls.style.display = speedControls.style.display === 'flex' ? 'none' : 'flex';
            });
            speedControls.addEventListener('click', (e) => {
                e.stopPropagation();
                if (e.target.tagName === 'BUTTON') {
                    const speed = parseFloat(e.target.getAttribute('data-speed'));
                    videoEl.playbackRate = speed;
                    speedControls.querySelectorAll('button').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    speedControls.style.display = 'none';
                    localStorage.setItem('videoSpeed', speed);
                }
            });
            document.addEventListener('click', (e) => {
                if (!speedControls.contains(e.target) && !settingsBtn.contains(e.target)) speedControls.style.display = 'none';
            });

            // Touch gestures
            videoEl.addEventListener('touchstart', (e) => { lastTap = lastTap || 0; });
            videoEl.addEventListener('touchend', (e) => {
                const now = Date.now();
                const tapLen = now - lastTap;
                const rect = videoEl.getBoundingClientRect();
                const x = e.changedTouches[0].clientX - rect.left;
                if (tapLen < 300 && tapLen > 0) {
                    if (x > rect.width / 2) { videoEl.currentTime = Math.min(videoEl.duration || 0, videoEl.currentTime + 10); showSeekAnimation('<i class="fas fa-forward"></i>', seekOverlay); }
                    else { videoEl.currentTime = Math.max(0, videoEl.currentTime - 10); showSeekAnimation('<i class="fas fa-backward"></i>', seekOverlay); }
                } else {
                    togglePlay();
                    showControls();
                }
                lastTap = now;
            });

            // Auto-hide controls
            function showControls() {
                containerEl.classList.add('show-controls');
                clearTimeout(controlsTimeout);
                controlsTimeout = setTimeout(() => {
                    if (!videoEl.paused) containerEl.classList.remove('show-controls');
                }, 3000);
            }
            containerEl.addEventListener('mousemove', showControls);
            containerEl.addEventListener('mouseenter', showControls);

            // Load saved prefs
            const savedVolume = localStorage.getItem('videoVolume');
            if (savedVolume !== null) {
                volumeSlider.value = savedVolume;
                videoEl.volume = parseFloat(savedVolume);
                videoEl.muted = parseFloat(savedVolume) === 0;
            }
            const savedSpeed = localStorage.getItem('videoSpeed');
            if (savedSpeed) {
                videoEl.playbackRate = parseFloat(savedSpeed);
                speedControls.querySelectorAll('button').forEach(btn => {
                    btn.classList.toggle('active', btn.getAttribute('data-speed') === savedSpeed);
                });
            }

            // Init visuals
            updateTimes();
            updateVolumeIcon();
            updateVolumeSliderVisual();
        }

        // Create players
        if (video && videoPlayer) {
            createVideoPlayer(video, videoPlayer, {
                playPauseBtn, progressBarContainer, progressBar, bufferedBar, currentTimeEl, durationEl,
                volumeBtn, volumeSlider, fullscreenBtn, settingsBtn, speedControls, seekOverlay,
                videoLoading, videoError, pipBtn, pipOverlay
            });
        }
        if (videoEn && videoPlayerEn) {
            createVideoPlayer(videoEn, videoPlayerEn, {
                playPauseBtn: playPauseBtnEn, progressBarContainer: progressBarContainerEn, progressBar: progressBarEn, bufferedBar: bufferedBarEn,
                currentTimeEl: currentTimeElEn, durationEl: durationElEn, volumeBtn: volumeBtnEn, volumeSlider: volumeSliderEn,
                fullscreenBtn: fullscreenBtnEn, settingsBtn: settingsBtnEn, speedControls: speedControlsEn, seekOverlay: seekOverlayEn,
                videoLoading: videoLoadingEn, videoError: videoErrorEn, pipBtn: pipBtnEn, pipOverlay: pipOverlayEn
            });
        }

        // Utils
        function showSeekAnimation(icon, overlayElement) {
            overlayElement.innerHTML = icon;
            overlayElement.classList.add('active');
            setTimeout(() => overlayElement.classList.remove('active'), 500);
        }
        function showNotification(message, overlayElement) {
            overlayElement.textContent = message;
            overlayElement.classList.add('active');
            setTimeout(() => overlayElement.classList.remove('active'), 1800);
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', e => {
            const tag = document.activeElement.tagName.toLowerCase();
            if (tag === 'input' || tag === 'textarea') return;

            const currentVideo = isArabic ? video : videoEn;
            const currentVolumeSlider = isArabic ? volumeSlider : volumeSliderEn;
            const currentContainer = isArabic ? videoPlayer : videoPlayerEn;
            if (!currentVideo) return;

            switch (e.key.toLowerCase()) {
                case ' ':
                case 'k':
                    e.preventDefault();
                    currentVideo.paused ? currentVideo.play() : currentVideo.pause();
                    break;
                case 'm':
                    e.preventDefault();
                    currentVideo.muted = !currentVideo.muted;
                    currentVolumeSlider.value = currentVideo.muted ? 0 : (localStorage.getItem('videoVolume') || 1);
                    currentVolumeSlider.dispatchEvent(new Event('input'));
                    break;
                case 'f':
                    e.preventDefault();
                    if (!document.fullscreenElement) currentContainer.requestFullscreen?.();
                    else document.exitFullscreen?.();
                    break;
                case 'arrowleft':
                    e.preventDefault();
                    currentVideo.currentTime = Math.max(0, currentVideo.currentTime - 5);
                    break;
                case 'arrowright':
                    e.preventDefault();
                    currentVideo.currentTime = Math.min(currentVideo.duration || 0, currentVideo.currentTime + 5);
                    break;
                case 'arrowup':
                    e.preventDefault();
                    currentVolumeSlider.value = Math.min(1, parseFloat(currentVolumeSlider.value) + 0.1);
                    currentVolumeSlider.dispatchEvent(new Event('input'));
                    break;
                case 'arrowdown':
                    e.preventDefault();
                    currentVolumeSlider.value = Math.max(0, parseFloat(currentVolumeSlider.value) - 0.1);
                    currentVolumeSlider.dispatchEvent(new Event('input'));
                    break;
                case 'j':
                    e.preventDefault();
                    currentVideo.currentTime = Math.max(0, currentVideo.currentTime - 10);
                    break;
                case 'l':
                    e.preventDefault();
                    currentVideo.currentTime = Math.min(currentVideo.duration || 0, currentVideo.currentTime + 10);
                    break;
                case 'home':
                    e.preventDefault();
                    currentVideo.currentTime = 0;
                    break;
                case 'end':
                    e.preventDefault();
                    if (isFinite(currentVideo.duration)) currentVideo.currentTime = currentVideo.duration;
                    break;
            }
        });

        // Translation
        function applyLanguage(arabic) {
            isArabic = arabic;
            const lang = isArabic ? 'ar' : 'en';
            const dir = isArabic ? 'rtl' : 'ltr';
            html.setAttribute('lang', lang);
            html.setAttribute('dir', dir);
            body.setAttribute('dir', dir);
            arabicContent.classList.toggle('hidden', !isArabic);
            englishContent.classList.toggle('hidden', isArabic);
            translationText.textContent = isArabic ? 'ØªØ±Ø¬Ù…Ø©' : 'Translate';
            document.title = isArabic ? 'Ø¯Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„: Ø£Ø³Ø§Ø³ÙŠØ§Øª Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø© - Ù…Ù†ØµØ© Ø£Ø«Ø±' : 'Comprehensive Guide: Accounting Fundamentals - Athr Platform';
            const aiChatTitle = document.getElementById('ai-chat-title');
            aiChatTitle.textContent = isArabic ? 'Ø§Ø³Ø£Ù„ Ø£Ø«Ø± AI' : 'Ask Athr AI';
            aiChatInput.placeholder = isArabic ? 'Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§...' : 'Type your question here...';
            aiChatButtonText.textContent = isArabic ? 'Ø£Ø«Ø± AI' : 'Athr AI';
            [video, videoEn].forEach(v => { if (v && !v.paused) v.pause(); });
        }
        translationButton.addEventListener('click', () => applyLanguage(!isArabic));
        applyLanguage(true);

        // AI Chat (demo)
        aiChatButton.addEventListener('click', () => {
            aiChatModal.classList.add('visible');
            aiChatInput.focus();
        });
        aiChatCloseBtn.addEventListener('click', () => aiChatModal.classList.remove('visible'));
        aiChatModal.addEventListener('click', (e) => { if (e.target === aiChatModal) aiChatModal.classList.remove('visible'); });
        aiChatSendBtn.addEventListener('click', () => {
            const txt = aiChatInput.value.trim(); if (!txt) return;
            const divU = document.createElement('div'); divU.className = 'chat-message user-message'; divU.textContent = txt;
            aiChatMessages.appendChild(divU); aiChatInput.value = '';
            const typing = document.createElement('div'); typing.className = 'chat-message ai-message typing-indicator';
            typing.innerHTML = '<span>Ø£Ø«Ø± AI ÙŠÙƒØªØ¨ Ø§Ù„Ø¢Ù†</span><span class="dot">.</span><span class="dot">.</span><span class="dot">.</span>';
            aiChatMessages.appendChild(typing); aiChatMessages.scrollTop = aiChatMessages.scrollHeight;
            setTimeout(() => {
                typing.remove();
                const reply = document.createElement('div'); reply.className = 'chat-message ai-message';
                reply.textContent = 'Ø´ÙƒØ±Ù‹Ø§! ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø³Ø¤Ø§Ù„Ùƒ. Ø³Ù†Ø¹Ù…Ù„ Ø¹Ù„Ù‰ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ.';
                aiChatMessages.appendChild(reply); aiChatMessages.scrollTop = aiChatMessages.scrollHeight;
            }, 1400);
        });
        aiChatInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') aiChatSendBtn.click(); });
    });
    </script>
</body>
</html>
