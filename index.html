<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>دليل أساسيات المحاسبة - منصة أثر</title>
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- marked.js for Markdown parsing -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <style>
        :root {
            --glass-bg: rgba(255,255,255,0.18);
            --glass-border: rgba(255,255,255,0.4);
            --text-color: #1e293b;
            --highlight-color: #0ea5e9;
            --practice-color: #16a34a;
            --translation-color: #8b5cf6;
            --video-color: #dc2626;
            --border-radius: 24px;
        }

        /* Animations */
        @keyframes gradientAnimation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes floatSphere1 {
            0%, 100% { transform: translateY(0px) rotate(0deg) scale(1); }
            50% { transform: translateY(-30px) rotate(180deg) scale(1.05); }
        }

        @keyframes floatSphere2 {
            0%, 100% { transform: translateX(0px) translateY(0px) rotate(0deg) scale(1); }
            50% { transform: translateX(25px) translateY(-25px) rotate(-180deg) scale(0.95); }
        }

        @keyframes floatSphere3 {
            0%, 100% { transform: translateX(0px) translateY(0px) rotate(0deg) scale(1); }
            50% { transform: translateX(-20px) translateY(35px) rotate(120deg) scale(1.08); }
        }

        @keyframes translate-glow {
            0%, 100% { box-shadow: 0 0 15px -5px rgba(139,92,246,0.4), inset 0 2px 0 rgba(255,255,255,0.4); }
            50% { box-shadow: 0 0 25px 0px rgba(139,92,246,0.6), inset 0 2px 0 rgba(255,255,255,0.6); }
        }

        @keyframes video-glow {
            0%, 100% { box-shadow: 0 0 15px -5px rgba(220,38,38,0.4), inset 0 2px 0 rgba(255,255,255,0.4); }
            50% { box-shadow: 0 0 25px 0px rgba(220,38,38,0.6), inset 0 2px 0 rgba(255,255,255,0.6); }
        }

        @keyframes pulse-correct {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes shake-wrong {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Reset and Base Styles */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            font-size: 16px;
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #e0f2fe;
            color: var(--text-color);
            line-height: 1.8;
            overflow-x: hidden;
            position: relative;
            direction: rtl;
            font-size: clamp(0.9rem, 2.5vw, 1.05rem);
            padding: 20px clamp(10px, 3vw, 20px);
        }

        body[dir="ltr"] {
            direction: ltr;
        }

        /* Background Elements */
        .background-gradient, .floating-spheres {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
        }

        .background-gradient {
            background: linear-gradient(135deg, #e0f2fe 0%, #bae6fd 25%, #fce7f3 75%, #fdf2f8 100%);
            background-size: 400% 400%;
            animation: gradientAnimation 40s ease infinite;
        }

        .floating-spheres {
            z-index: -1;
            pointer-events: none;
        }

        .sphere {
            position: absolute;
            border-radius: 50%;
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255,255,255,0.3);
            box-shadow: 0 20px 60px rgba(14,165,233,0.3), inset 0 4px 0 rgba(255,255,255,0.4);
        }

        .sphere.large {
            width: clamp(120px, 20vw, 220px);
            height: clamp(120px, 20vw, 220px);
            top: 8%;
            right: 12%;
            background: radial-gradient(circle, #3b82f6, #1e3a8a);
            animation: floatSphere1 12s ease-in-out infinite;
        }

        .sphere.medium {
            width: clamp(80px, 15vw, 140px);
            height: clamp(80px, 15vw, 140px);
            bottom: 20%;
            left: 8%;
            background: radial-gradient(circle, #0ea5e9, #0369a1);
            animation: floatSphere2 9s ease-in-out infinite;
        }

        .sphere.small-1 {
            width: clamp(60px, 12vw, 95px);
            height: clamp(60px, 12vw, 95px);
            top: 50%;
            right: 8%;
            background: radial-gradient(circle, #06b6d4, #0e7490);
            animation: floatSphere3 6s ease-in-out infinite;
        }

        /* FAB Button Styles */
        .fab-button {
            position: fixed;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(25px);
            border: 2px solid var(--glass-border);
            border-radius: 50px;
            padding: clamp(8px, 2vw, 12px);
            cursor: pointer;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            width: clamp(50px, 12vw, 60px);
            height: clamp(50px, 12vw, 60px);
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: 0 8px 25px -10px rgba(0,0,0,0.2), inset 0 2px 0 rgba(255,255,255,0.5);
        }

        .fab-button:hover {
            width: auto;
            padding: clamp(8px, 2vw, 12px) clamp(16px, 4vw, 22px);
            transform: translateY(-3px);
        }

        .fab-button .icon {
            width: 28px;
            height: 28px;
            flex-shrink: 0;
            transition: transform 0.3s ease;
        }

        .fab-button:hover .icon {
            transform: scale(0.9);
        }

        .fab-text {
            font-size: clamp(0.85rem, 2.2vw, 1rem);
            font-weight: 600;
            white-space: nowrap;
            display: none;
            margin-left: 10px;
        }

        body[dir="ltr"] .fab-text {
            margin-left: 0;
            margin-right: 10px;
        }

        .fab-button:hover .fab-text {
            display: block;
        }

        .translation-button {
            top: clamp(20px, 5vw, 30px);
            right: clamp(20px, 5vw, 30px);
        }

        body[dir="ltr"] .translation-button {
            right: auto;
            left: clamp(20px, 5vw, 30px);
        }

        .translation-button:hover {
            border-color: var(--translation-color);
            background: rgba(139,92,246,0.1);
            animation: translate-glow 2.5s infinite alternate;
        }

        .translation-button .fab-text {
            color: var(--translation-color);
        }

        .video-button {
            top: clamp(90px, 12vw, 110px);
            right: clamp(20px, 5vw, 30px);
        }

        body[dir="ltr"] .video-button {
            right: auto;
            left: clamp(20px, 5vw, 30px);
        }

        .video-button:hover {
            border-color: var(--video-color);
            background: rgba(220,38,38,0.1);
            animation: video-glow 2.5s infinite alternate;
        }

        .video-button .fab-text {
            color: var(--video-color);
        }

        /* Video Player Styles */
        .video-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(10px);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .video-modal.visible {
            opacity: 1;
            pointer-events: auto;
        }

        .video-container {
            position: relative;
            width: 90%;
            max-width: 900px;
            background: rgba(255,255,255,0.1);
            border-radius: 2.5rem;
            overflow: hidden;
            backdrop-filter: blur(25px);
            border: 2px solid var(--glass-border);
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }

        .video-modal.visible .video-container {
            transform: scale(1);
        }

        .video-close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            transition: background-color 0.2s;
        }

        .video-close-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        /* Video Loading States */
        .video-loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 1.2rem;
            z-index: 5;
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(0,0,0,0.7);
            padding: 20px 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .video-loading .spinner {
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255,255,255,0.3);
            border-top: 3px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .video-error {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            text-align: center;
            z-index: 5;
            background: rgba(220,38,38,0.8);
            padding: 20px 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            display: none;
        }

        .video-info {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 8px 12px;
            border-radius: 10px;
            font-size: 0.8rem;
            backdrop-filter: blur(10px);
        }

        /* Video Controls */
        .controls-container {
            position: absolute;
            bottom: 1rem;
            left: 50%;
            transform: translateX(-50%);
            width: 95%;
            padding: 0.75rem 1.5rem;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            transition: opacity 0.3s ease-in-out;
            opacity: 0;
            z-index: 2;
        }

        .video-container:hover .controls-container,
        .video-container.paused .controls-container {
            opacity: 1;
        }

        .progress-bar-container {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
            cursor: pointer;
            position: relative;
            margin-bottom: 0.75rem;
        }

        .progress-bar {
            height: 100%;
            background: #fff;
            border-radius: 3px;
            width: 0%;
            position: relative;
            transition: width 0.1s linear;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            right: -6px;
            top: 50%;
            transform: translateY(-50%);
            width: 12px;
            height: 12px;
            background: #fff;
            border-radius: 50%;
        }

        .buffer-bar {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 3px;
            width: 0%;
            transition: width 0.1s linear;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
            width: 2.75rem;
            height: 2.75rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .control-btn:hover {
            transform: scale(1.1);
            background: rgba(255, 255, 255, 0.3);
        }

        .control-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .video-controls {
            display: flex;
            align-items: center;
            justify-content: space-between;
            color: white;
        }

        .left-controls, .right-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .time-display {
            font-size: 0.9rem;
            color: white;
            font-family: 'Courier New', monospace;
        }

        .quality-selector {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 0.8rem;
            cursor: pointer;
        }

        /* Interactive Quiz Styles */
        .quiz-container {
            margin: 20px 0;
        }

        .quiz-question {
            background: rgba(255,255,255,0.15);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            backdrop-filter: blur(20px);
            animation: fadeIn 0.6s ease;
        }

        .quiz-question h4 {
            margin-bottom: 15px;
            color: #0c4a6e;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .quiz-option {
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 12px;
            padding: 12px 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .quiz-option:hover {
            background: rgba(255,255,255,0.2);
            transform: translateX(-3px);
        }

        body[dir="ltr"] .quiz-option:hover {
            transform: translateX(3px);
        }

        .quiz-option.correct {
            background: rgba(22,163,74,0.2);
            border-color: #16a34a;
            animation: pulse-correct 0.6s ease;
        }

        .quiz-option.wrong {
            background: rgba(239,68,68,0.2);
            border-color: #ef4444;
            animation: shake-wrong 0.6s ease;
        }

        .quiz-option.disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        .option-letter {
            background: rgba(14,165,233,0.3);
            color: #0c4a6e;
            font-weight: bold;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        .quiz-result {
            margin-top: 15px;
            padding: 12px;
            border-radius: 10px;
            font-weight: 500;
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .quiz-result.correct {
            background: rgba(22,163,74,0.1);
            color: #15803d;
            display: block;
        }

        .quiz-result.wrong {
            background: rgba(239,68,68,0.1);
            color: #dc2626;
            display: block;
        }

        /* Main Content */
        .main-content {
            max-width: 1200px;
            margin: 90px auto 0;
            padding: clamp(20px, 5vw, 40px);
        }

        .glassy-card {
            background: var(--glass-bg);
            border: 2px solid var(--glass-border);
            border-radius: var(--border-radius);
            padding: clamp(20px, 5vw, 30px);
            margin-bottom: clamp(25px, 5vw, 35px);
            backdrop-filter: blur(25px);
            transition: all 0.4s ease;
            box-shadow: 0 20px 50px rgba(0,0,0,0.1), inset 0 2px 0 rgba(255,255,255,0.5);
        }

        .glassy-card:hover {
            transform: translateY(-5px) scale(1.01);
            border-color: rgba(255,255,255,0.7);
        }

        /* Typography */
        h1, h2, h3, h4, h5 {
            color: #0f172a;
            text-shadow: 0 2px 8px rgba(255,255,255,0.8);
            font-weight: 700;
        }

        h1 {
            font-size: clamp(2rem, 6vw, 3.2rem);
            text-align: center;
            margin-bottom: clamp(20px, 4vw, 30px);
            color: #0c4a6e;
        }

        h2 {
            font-size: clamp(1.5rem, 5vw, 2.5rem);
            border-bottom: 3px solid rgba(14,165,233,0.3);
            padding-bottom: clamp(10px, 2vw, 15px);
            margin-bottom: clamp(20px, 4vw, 30px);
        }

        h3 {
            font-size: clamp(1.2rem, 4vw, 1.8rem);
            margin-bottom: clamp(15px, 3vw, 20px);
        }

        h4 {
            font-size: clamp(1.1rem, 3.5vw, 1.5rem);
            margin-bottom: clamp(12px, 2.5vw, 18px);
        }

        p, li {
            color: #475569;
            margin-bottom: clamp(10px, 2vw, 12px);
        }

        strong {
            color: #1e3a8a;
        }

        ul, ol {
            padding-right: clamp(20px, 4vw, 25px);
            margin-bottom: 20px;
        }

        body[dir="ltr"] ul, body[dir="ltr"] ol {
            padding-right: 0;
            padding-left: clamp(20px, 4vw, 25px);
        }

        /* Special Components */
        .concept-card {
            background: rgba(255,255,255,0.15);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            backdrop-filter: blur(20px);
            transition: all 0.4s ease;
        }

        .concept-card:hover {
            transform: translateY(-5px);
            border-color: rgba(255,255,255,0.4);
            background: rgba(255,255,255,0.2);
        }

        .equation-box {
            background: linear-gradient(135deg, rgba(14,165,233,0.1), rgba(59,130,246,0.1));
            border: 2px solid rgba(14,165,233,0.3);
            border-radius: 16px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.4rem;
            font-weight: bold;
            color: #0c4a6e;
        }

        /* Tables */
        .table-container {
            overflow-x: auto;
            margin: 20px 0;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .business-table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(255,255,255,0.2);
            border-radius: 12px;
            overflow: hidden;
            backdrop-filter: blur(15px);
        }

        .business-table th, .business-table td {
            padding: clamp(8px, 2vw, 12px);
            border: 1px solid rgba(255,255,255,0.3);
            text-align: right;
            font-size: clamp(0.8rem, 2vw, 1rem);
            vertical-align: top;
        }

        body[dir="ltr"] .business-table th, body[dir="ltr"] .business-table td {
            text-align: left;
        }

        .business-table th {
            background: rgba(14,165,233,0.2);
            font-weight: 700;
            color: #0c4a6e;
            text-align: center;
        }

        .case-study {
            border-right: 4px solid var(--highlight-color);
            padding-right: 20px;
            margin: 25px 0;
        }

        body[dir="ltr"] .case-study {
            border-right: none;
            border-left: 4px solid var(--highlight-color);
            padding-right: 0;
            padding-left: 20px;
        }

        .hidden {
            display: none !important;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .video-container {
                width: 95%;
                border-radius: 1.5rem;
            }
            
            .controls-container {
                padding: 0.5rem 1rem;
            }
            
            .video-controls {
                flex-wrap: wrap;
                gap: 0.5rem;
            }
            
            .time-display {
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <!-- Background Elements -->
    <div class="background-gradient"></div>
    <div class="floating-spheres">
        <div class="sphere large"></div>
        <div class="sphere medium"></div>
        <div class="sphere small-1"></div>
    </div>

    <!-- Translation Button -->
    <button class="fab-button translation-button" id="translationButton">
        <svg class="icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M2.25 12C2.25 17.3848 6.61522 21.75 12 21.75C17.3848 21.75 21.75 17.3848 21.75 12C21.75 6.61522 17.3848 2.25 12 2.25C9.36657 2.25 6.94277 3.22321 5.16629 4.83371M12.75 2.25V7.5M12.75 7.5H18M12.75 7.5L5.16629 4.83371M11.25 21.75V16.5M11.25 16.5H6M11.25 16.5L18.8337 19.1663M5.16629 4.83371C3.22321 6.94277 2.25 9.36657 2.25 12M2.25 12C2.25 14.6334 3.22321 17.0572 4.83371 18.8337M18.8337 19.1663C20.7768 17.0572 21.75 14.6334 21.75 12M18.8337 4.83371C17.0572 3.22321 14.6334 2.25 12 2.25" stroke="#8b5cf6" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span class="fab-text">ترجمة</span>
    </button>

    <!-- Video Button -->
    <button class="fab-button video-button" id="videoButton">
        <svg class="icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M14.7348 14.7348L19.2614 19.2614M16.4982 11.2491C16.4982 14.5623 13.8114 17.2491 10.4982 17.2491C7.18497 17.2491 4.49817 14.5623 4.49817 11.2491C4.49817 7.93588 7.18497 5.24908 10.4982 5.24908C13.8114 5.24908 16.4982 7.93588 16.4982 11.2491Z" stroke="#dc2626" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="#dc2626" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M10 8.5V15.5L15 12L10 8.5Z" fill="#dc2626"/>
        </svg>
        <span class="fab-text">فيديو</span>
    </button>

    <!-- Video Modal -->
    <div class="video-modal" id="videoModal">
        <div class="video-container" id="videoPlayer">
            <button class="video-close-btn" id="videoCloseBtn">×</button>
            
            <!-- Video Info -->
            <div class="video-info" id="videoInfo">
                <div>لغة الأعمال: مقدمة للمحاسبة</div>
                <div style="font-size: 0.7rem; opacity: 0.8;">Internet Archive</div>
            </div>
            
            <!-- Loading State -->
            <div class="video-loading" id="videoLoading">
                <div class="spinner"></div>
                <span id="loadingText">جاري تحميل الفيديو...</span>
            </div>
            
            <!-- Error State -->
            <div class="video-error" id="videoError">
                <i class="fas fa-exclamation-triangle" style="font-size: 2rem; margin-bottom: 10px;"></i>
                <div id="errorText">خطأ في تحميل الفيديو</div>
                <button onclick="retryVideo()" style="background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3); color: white; padding: 8px 16px; border-radius: 8px; margin-top: 10px; cursor: pointer;">إعادة المحاولة</button>
            </div>
            
            <!-- Video element -->
            <video id="video" style="width: 100%; height: auto; object-fit: cover;" crossorigin="anonymous" preload="metadata">
                <source src="https://archive.org/download/20250916_20250916_0112/%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D8%A3%D8%B9%D9%85%D8%A7%D9%84__%D9%85%D9%82%D8%AF%D9%85%D8%A9_%D9%84%D9%84%D9%85%D8%AD%D8%A7%D8%B3%D8%A8%D8%A9.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
            
            <!-- Custom Controls -->
            <div class="controls-container">
                <!-- Progress bar -->
                <div class="progress-bar-container" id="progressBarContainer">
                    <div class="buffer-bar" id="bufferBar"></div>
                    <div class="progress-bar" id="progressBar"></div>
                </div>
                
                <div class="video-controls">
                    <!-- Left Controls -->
                    <div class="left-controls">
                        <button id="playPauseBtn" class="control-btn" aria-label="Play">
                            <i class="fas fa-play"></i>
                        </button>
                        <button id="volumeBtn" class="control-btn" aria-label="Mute">
                            <i class="fas fa-volume-up"></i>
                        </button>
                        <input type="range" id="volumeSlider" min="0" max="1" step="0.1" value="1" style="width: 80px; margin: 0 10px;">
                    </div>
                    
                    <!-- Center Time -->
                    <div class="time-display">
                        <span id="currentTime">0:00</span> / <span id="duration">0:00</span>
                    </div>
                    
                    <!-- Right Controls -->
                    <div class="right-controls">
                        <select class="quality-selector" id="qualitySelector">
                            <option value="auto">تلقائي</option>
                            <option value="720p">720p</option>
                            <option value="480p">480p</option>
                            <option value="360p">360p</option>
                        </select>
                        <button id="fullscreenBtn" class="control-btn" aria-label="Enter Fullscreen">
                            <i class="fas fa-expand"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <main class="main-content">
        <!-- Arabic Content -->
        <div id="arabicContent">
            <section class="glassy-card">
                <h1>دليل أساسيات المحاسبة - منصة أثر</h1>
                <p style="text-align: center; font-size: 1.1rem; color: #475569;">مرحباً أحمد، أنا مساعدك التعليمي من منصة أثر</p>
            </section>

            <section class="glassy-card">
                <h2>خريطة أثر للتركيز الذكي</h2>
                <div class="concept-card">
                    <p><strong>زبدة المحاضرة:</strong> الهدف الأساسي للمحاسبة هو توفير معلومات مالية مفيدة عن منظمة معينة للمستخدمين المهتمين لاتخاذ قرارات مدروسة، وذلك عبر نظام معلومات يحدد ويسجل ويُوصّل الأحداث الاقتصادية الخاصة بالمنشأة.</p>
                </div>
            </section>

            <section class="glassy-card">
                <h2>مفاهيم/أساليب أساسية (80% تركيز)</h2>
                <div class="concept-card">
                    <h4>تعريف المحاسبة وأنشطتها الثلاثة</h4>
                    <p><strong>النشاط الأول - التحديد:</strong> تحديد الأحداث الاقتصادية المهمة وفصلها عن الأحداث غير الاقتصادية.</p>
                    <p><strong>النشاط الثاني - التسجيل:</strong> تسجيل وتصنيف وتلخيص الأحداث الاقتصادية بطريقة منهجية ومنطقية.</p>
                    <p><strong>النشاط الثالث - التوصيل:</strong> توصيل المعلومات المحاسبية للمستخدمين المهتمين من خلال التقارير المحاسبية.</p>
                </div>

                <div class="concept-card">
                    <h4>المعادلة المحاسبية الأساسية</h4>
                    <div class="equation-box">
                        الأصول = الالتزامات + حقوق الملكية
                    </div>
                    <p><strong>الشرح:</strong> تموَّل الأصول إما بالديون (التزامات) أو باستثمارات الملاك (حقوق ملكية)، ويجب أن تبقى هذه المعادلة متوازنة بعد كل عملية.</p>
                    <p><strong>مثال عملي:</strong> إذا كانت الأصول 100,000 وحقوق الملكية 70,000، فإن الالتزامات = 30,000</p>
                </div>

                <div class="concept-card">
                    <h4>مكونات تعريف المحاسبة الخمسة</h4>
                    <ol>
                        <li><strong>الوحدة الاقتصادية:</strong> الشركة منفصلة عن أصحابها</li>
                        <li><strong>المعاملات التجارية:</strong> أحداث قابلة للقياس بالنقود</li>
                        <li><strong>الأنشطة المحاسبية:</strong> التحديد والتسجيل والتوصيل</li>
                        <li><strong>نظام المعلومات:</strong> معالجة البيانات وإنتاج التقارير</li>
                        <li><strong>المستخدمون المهتمون:</strong> من يحتاجون المعلومات المالية</li>
                    </ol>
                </div>
            </section>

            <section class="glassy-card">
                <h2>تفاصيل داعمة وتنبيهات (20% تركيز)</h2>
                <div class="concept-card">
                    <h4>شروط تسجيل المعاملات</h4>
                    <ul>
                        <li>أن تؤثر على الوحدة الاقتصادية</li>
                        <li>أن يكون أثرها قابلاً للقياس بالنقود</li>
                    </ul>
                    <p><strong>مثال:</strong> في متجر قهوة، شراء مخزون بقيمة 500 يعتبر حدثاً اقتصادياً يُسجل كمخزون مقابل نقد، بينما محادثة غير مالية لا تُسجل.</p>
                </div>

                <div class="concept-card">
                    <h4>المحاسبة كنظام معلومات</h4>
                    <ul>
                        <li><strong>مدخلات:</strong> أحداث اقتصادية</li>
                        <li><strong>معالجة:</strong> تسجيل وتلخيص</li>
                        <li><strong>مخرجات:</strong> قوائم مالية</li>
                    </ul>
                </div>

                <div class="concept-card">
                    <h4>المستخدمون الداخليون والخارجيون</h4>
                    <p><strong>داخلياً:</strong> الإدارة والإنتاج والتسويق والمالية</p>
                    <p><strong>خارجياً:</strong> المستثمرون والدائنون والضرائب والعملاء وجهات السوق</p>
                </div>
            </section>

            <section class="glassy-card">
                <h3>جدول المصطلحات</h3>
                <div class="table-container">
                    <table class="business-table">
                        <thead>
                            <tr>
                                <th>المصطلح العربي</th>
                                <th>المقابل الإنجليزي</th>
                                <th>التعريف</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>المحاسبة</strong></td>
                                <td>Accounting</td>
                                <td>نظام معلومات لتحديد وتسجيل وتوصيل الأحداث الاقتصادية</td>
                            </tr>
                            <tr>
                                <td><strong>الأصول</strong></td>
                                <td>Assets</td>
                                <td>الموارد الاقتصادية التي تمتلكها الشركة ويتوقع أن تفيدها مستقبلاً</td>
                            </tr>
                            <tr>
                                <td><strong>الالتزامات</strong></td>
                                <td>Liabilities</td>
                                <td>الديون أو الالتزامات تجاه الأطراف الأخرى (الدائنون)</td>
                            </tr>
                            <tr>
                                <td><strong>حقوق الملكية</strong></td>
                                <td>Owner's Equity</td>
                                <td>حق المالكين في الأصول بعد سداد الالتزامات</td>
                            </tr>
                            <tr>
                                <td><strong>الوحدة الاقتصادية</strong></td>
                                <td>Economic Entity</td>
                                <td>وحدة عمل تُفصل معاملاتها عن المالكين</td>
                            </tr>
                            <tr>
                                <td><strong>المعاملات التجارية</strong></td>
                                <td>Business Transactions</td>
                                <td>أحداث اقتصادية قابلة للقياس النقدي تؤثر على المركز المالي</td>
                            </tr>
                            <tr>
                                <td><strong>القوائم المالية</strong></td>
                                <td>Financial Statements</td>
                                <td>تقارير تُلخّص الأداء والوضع المالي</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section class="glassy-card">
                <h2>أسئلة محتملة للامتحان</h2>
                <div class="concept-card">
                    <h4>أسئلة مقالية</h4>
                    <ol>
                        <li>عرّف المحاسبة واشرح أنشطتها الثلاثة الرئيسية بإيجاز</li>
                        <li>ما هي المعادلة المحاسبية الأساسية؟ عرّف كل عنصر فيها</li>
                        <li>فرّق بين المستخدمين الداخليين والخارجيين مع مثال لكل فئة</li>
                        <li>اذكر شرطي تسجيل المعاملة في الدفاتر المحاسبية</li>
                    </ol>
                </div>

                <div class="quiz-container">
                    <div class="quiz-question">
                        <h4>1. أي مما يلي يُعد مستخدماً خارجياً للمعلومات المحاسبية؟</h4>
                        <div class="quiz-options">
                            <div class="quiz-option" data-question="1" data-correct="false">
                                <span class="option-letter">أ</span>
                                <span>مدير التسويق</span>
                            </div>
                            <div class="quiz-option" data-question="1" data-correct="false">
                                <span class="option-letter">ب</span>
                                <span>قسم الإنتاج</span>
                            </div>
                            <div class="quiz-option" data-question="1" data-correct="true">
                                <span class="option-letter">ج</span>
                                <span>مصلحة الضرائب</span>
                            </div>
                            <div class="quiz-option" data-question="1" data-correct="false">
                                <span class="option-letter">د</span>
                                <span>مدير الموارد البشرية</span>
                            </div>
                        </div>
                        <div class="quiz-result" id="result1"></div>
                    </div>

                    <div class="quiz-question">
                        <h4>2. المعادلة المحاسبية الأساسية هي:</h4>
                        <div class="quiz-options">
                            <div class="quiz-option" data-question="2" data-correct="false">
                                <span class="option-letter">أ</span>
                                <span>الأصول = الالتزامات − حقوق الملكية</span>
                            </div>
                            <div class="quiz-option" data-question="2" data-correct="true">
                                <span class="option-letter">ب</span>
                                <span>الأصول = الالتزامات + حقوق الملكية</span>
                            </div>
                            <div class="quiz-option" data-question="2" data-correct="false">
                                <span class="option-letter">ج</span>
                                <span>الأصول + الالتزامات = حقوق الملكية</span>
                            </div>
                            <div class="quiz-option" data-question="2" data-correct="false">
                                <span class="option-letter">د</span>
                                <span>الأصول + حقوق الملكية = الالتزامات</span>
                            </div>
                        </div>
                        <div class="quiz-result" id="result2"></div>
                    </div>

                    <div class="quiz-question">
                        <h4>3. شراء أثاث مكتبي على الحساب يؤدي إلى:</h4>
                        <div class="quiz-options">
                            <div class="quiz-option" data-question="3" data-correct="false">
                                <span class="option-letter">أ</span>
                                <span>زيادة في الأصول ونقص في الأصول</span>
                            </div>
                            <div class="quiz-option" data-question="3" data-correct="false">
                                <span class="option-letter">ب</span>
                                <span>زيادة في الأصول وزيادة في حقوق الملكية</span>
                            </div>
                            <div class="quiz-option" data-question="3" data-correct="true">
                                <span class="option-letter">ج</span>
                                <span>زيادة في الأصول وزيادة في الالتزامات</span>
                            </div>
                            <div class="quiz-option" data-question="3" data-correct="false">
                                <span class="option-letter">د</span>
                                <span>نقص في الأصول ونقص في الالتزامات</span>
                            </div>
                        </div>
                        <div class="quiz-result" id="result3"></div>
                    </div>
                </div>
            </section>

            <section class="glassy-card">
                <h2>جسور معرفية</h2>
                <div class="concept-card">
                    <h4>المحاسبة لغة الأعمال</h4>
                    <p>قواعدها ومفاهيمها تُمكّن من تواصل مالي واضح لاتخاذ القرار في عالم الأعمال.</p>
                </div>

                <div class="concept-card">
                    <h4>الغاية هي اتخاذ القرار</h4>
                    <p>التقارير ليست غاية بحد ذاتها بل وسيلة لقرارات أفضل للمستثمرين والإدارة.</p>
                </div>

                <div class="concept-card">
                    <h4>الكيان الاقتصادي المستقل</h4>
                    <p>فصل معاملات المنشأة عن الملاك لضمان موثوقية وشفافية التقارير المالية.</p>
                </div>
            </section>
        </div>

        <!-- English Content -->
        <div id="englishContent" class="hidden">
            <section class="glassy-card">
                <h1>Comprehensive Guide: Accounting Fundamentals</h1>
                <p style="text-align: center; font-size: 1.1rem; color: #475569;">Welcome Ahmed, I am your educational assistant from Athr Platform</p>
            </section>

            <section class="glassy-card">
                <h2>Athr Map for Smart Focus</h2>
                <div class="concept-card">
                    <p><strong>Lecture Summary:</strong> The main objective of accounting is to provide useful financial information about a specific organization to interested users for making informed decisions, through an information system that identifies, records, and communicates the economic events of the entity.</p>
                </div>
            </section>

            <section class="glassy-card">
                <h2>Core Concepts (80% Focus)</h2>
                <div class="concept-card">
                    <h4>Definition of Accounting and Its Three Activities</h4>
                    <p><strong>First Activity - Identifying:</strong> Identifying important economic events and separating them from non-economic events.</p>
                    <p><strong>Second Activity - Recording:</strong> Recording, classifying, and summarizing economic events in a systematic and logical manner.</p>
                    <p><strong>Third Activity - Communicating:</strong> Communicating accounting information to interested users through accounting reports.</p>
                </div>

                <div class="concept-card">
                    <h4>Basic Accounting Equation</h4>
                    <div class="equation-box">
                        Assets = Liabilities + Owner's Equity
                    </div>
                    <p><strong>Explanation:</strong> Assets are financed either by debts (liabilities) or by owner investments (owner's equity), and this equation must remain balanced after every transaction.</p>
                    <p><strong>Practical Example:</strong> If assets are 100,000 and owner's equity is 70,000, then liabilities = 30,000</p>
                </div>

                <div class="concept-card">
                    <h4>Five Components of Accounting Definition</h4>
                    <ol>
                        <li><strong>Economic Entity:</strong> The company is separate from its owners</li>
                        <li><strong>Business Transactions:</strong> Events measurable in monetary terms</li>
                        <li><strong>Accounting Activities:</strong> Identifying, recording, and communicating</li>
                        <li><strong>Information System:</strong> Processing data and producing reports</li>
                        <li><strong>Interested Users:</strong> Those who need financial information</li>
                    </ol>
                </div>
            </section>

            <section class="glassy-card">
                <h2>Supporting Details and Alerts (20% Focus)</h2>
                <div class="concept-card">
                    <h4>Conditions for Recording Transactions</h4>
                    <ul>
                        <li>Must affect the economic entity</li>
                        <li>Its impact must be measurable in monetary terms</li>
                    </ul>
                    <p><strong>Example:</strong> In a coffee shop, purchasing inventory worth 500 is recorded because it affects the shop and is measured in money, while non-financial conversation is not recorded.</p>
                </div>

                <div class="concept-card">
                    <h4>Accounting as an Information System</h4>
                    <ul>
                        <li><strong>Inputs:</strong> Economic events</li>
                        <li><strong>Processing:</strong> Recording and summarizing</li>
                        <li><strong>Outputs:</strong> Financial statements</li>
                    </ul>
                </div>

                <div class="concept-card">
                    <h4>Internal and External Users</h4>
                    <p><strong>Internal:</strong> Management, Production, Marketing, Finance</p>
                    <p><strong>External:</strong> Investors, Creditors, Tax Authority, Customers, Market Entities</p>
                </div>
            </section>

            <section class="glassy-card">
                <h3>Basic Terms Table</h3>
                <div class="table-container">
                    <table class="business-table">
                        <thead>
                            <tr>
                                <th>Arabic Term</th>
                                <th>English Equivalent</th>
                                <th>Definition</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>المحاسبة</strong></td>
                                <td>Accounting</td>
                                <td>Information system for identifying, recording, and communicating economic events</td>
                            </tr>
                            <tr>
                                <td><strong>الأصول</strong></td>
                                <td>Assets</td>
                                <td>Economic resources owned by the company expected to benefit it in the future</td>
                            </tr>
                            <tr>
                                <td><strong>الالتزامات</strong></td>
                                <td>Liabilities</td>
                                <td>Debts or obligations to other parties (creditors)</td>
                            </tr>
                            <tr>
                                <td><strong>حقوق الملكية</strong></td>
                                <td>Owner's Equity</td>
                                <td>Owner's rights in assets after paying liabilities</td>
                            </tr>
                            <tr>
                                <td><strong>الوحدة الاقتصادية</strong></td>
                                <td>Economic Entity</td>
                                <td>Business unit whose transactions are separated from owners</td>
                            </tr>
                            <tr>
                                <td><strong>المعاملات التجارية</strong></td>
                                <td>Business Transactions</td>
                                <td>Economic events measurable monetarily affecting financial position</td>
                            </tr>
                            <tr>
                                <td><strong>القوائم المالية</strong></td>
                                <td>Financial Statements</td>
                                <td>Reports summarizing performance and financial position</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section class="glassy-card">
                <h2>Potential Exam Questions</h2>
                <div class="concept-card">
                    <h4>Essay Questions</h4>
                    <ol>
                        <li>Define accounting and briefly explain its three main activities</li>
                        <li>What is the basic accounting equation? Define each element in it</li>
                        <li>Differentiate between internal and external users with an example for each category</li>
                        <li>State the two conditions for recording a transaction in accounting books</li>
                    </ol>
                </div>

                <div class="quiz-container">
                    <div class="quiz-question">
                        <h4>1. Which of the following is considered an external user of accounting information?</h4>
                        <div class="quiz-options">
                            <div class="quiz-option" data-question="1-en" data-correct="false">
                                <span class="option-letter">A</span>
                                <span>Marketing Manager</span>
                            </div>
                            <div class="quiz-option" data-question="1-en" data-correct="false">
                                <span class="option-letter">B</span>
                                <span>Production Department</span>
                            </div>
                            <div class="quiz-option" data-question="1-en" data-correct="true">
                                <span class="option-letter">C</span>
                                <span>Tax Authority</span>
                            </div>
                            <div class="quiz-option" data-question="1-en" data-correct="false">
                                <span class="option-letter">D</span>
                                <span>HR Manager</span>
                            </div>
                        </div>
                        <div class="quiz-result" id="result1-en"></div>
                    </div>

                    <div class="quiz-question">
                        <h4>2. The basic accounting equation is:</h4>
                        <div class="quiz-options">
                            <div class="quiz-option" data-question="2-en" data-correct="false">
                                <span class="option-letter">A</span>
                                <span>Assets = Liabilities − Owner's Equity</span>
                            </div>
                            <div class="quiz-option" data-question="2-en" data-correct="true">
                                <span class="option-letter">B</span>
                                <span>Assets = Liabilities + Owner's Equity</span>
                            </div>
                            <div class="quiz-option" data-question="2-en" data-correct="false">
                                <span class="option-letter">C</span>
                                <span>Assets + Liabilities = Owner's Equity</span>
                            </div>
                            <div class="quiz-option" data-question="2-en" data-correct="false">
                                <span class="option-letter">D</span>
                                <span>Assets + Owner's Equity = Liabilities</span>
                            </div>
                        </div>
                        <div class="quiz-result" id="result2-en"></div>
                    </div>

                    <div class="quiz-question">
                        <h4>3. Purchasing office furniture on account leads to:</h4>
                        <div class="quiz-options">
                            <div class="quiz-option" data-question="3-en" data-correct="false">
                                <span class="option-letter">A</span>
                                <span>Increase in assets and decrease in assets</span>
                            </div>
                            <div class="quiz-option" data-question="3-en" data-correct="false">
                                <span class="option-letter">B</span>
                                <span>Increase in assets and increase in owner's equity</span>
                            </div>
                            <div class="quiz-option" data-question="3-en" data-correct="true">
                                <span class="option-letter">C</span>
                                <span>Increase in assets and increase in liabilities</span>
                            </div>
                            <div class="quiz-option" data-question="3-en" data-correct="false">
                                <span class="option-letter">D</span>
                                <span>Decrease in assets and decrease in liabilities</span>
                            </div>
                        </div>
                        <div class="quiz-result" id="result3-en"></div>
                    </div>
                </div>
            </section>

            <section class="glassy-card">
                <h2>Knowledge Bridges</h2>
                <div class="concept-card">
                    <h4>Accounting as the Language of Business</h4>
                    <p>Accounting rules and concepts enable clear financial communication for decision-making in the business world.</p>
                </div>

                <div class="concept-card">
                    <h4>The Goal is Decision Making</h4>
                    <p>Financial reports are not an end in themselves but a means for better decisions by investors and management.</p>
                </div>

                <div class="concept-card">
                    <h4>Independent Economic Entity</h4>
                    <p>Separating entity transactions from owners to ensure reliability and transparency of financial reports.</p>
                </div>
            </section>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- Translation Logic ---
            const translationButton = document.getElementById('translationButton');
            const translationText = translationButton.querySelector('.fab-text');
            const arabicContent = document.getElementById('arabicContent');
            const englishContent = document.getElementById('englishContent');
            const html = document.documentElement;
            const body = document.body;
            let isArabic = true;

            // --- Video Elements ---
            const videoButton = document.getElementById('videoButton');
            const videoModal = document.getElementById('videoModal');
            const videoCloseBtn = document.getElementById('videoCloseBtn');
            const videoPlayer = document.getElementById('videoPlayer');
            const video = document.getElementById('video');
            const playPauseBtn = document.getElementById('playPauseBtn');
            const progressBarContainer = document.getElementById('progressBarContainer');
            const progressBar = document.getElementById('progressBar');
            const bufferBar = document.getElementById('bufferBar');
            const currentTimeEl = document.getElementById('currentTime');
            const durationEl = document.getElementById('duration');
            const volumeBtn = document.getElementById('volumeBtn');
            const volumeSlider = document.getElementById('volumeSlider');
            const fullscreenBtn = document.getElementById('fullscreenBtn');
            const qualitySelector = document.getElementById('qualitySelector');
            const videoText = videoButton.querySelector('.fab-text');
            const videoLoading = document.getElementById('videoLoading');
            const videoError = document.getElementById('videoError');
            const loadingText = document.getElementById('loadingText');
            const errorText = document.getElementById('errorText');

            function applyLanguage(arabic) {
                isArabic = arabic;
                const lang = isArabic ? 'ar' : 'en';
                const dir = isArabic ? 'rtl' : 'ltr';

                html.setAttribute('lang', lang);
                html.setAttribute('dir', dir);
                body.setAttribute('dir', dir);

                arabicContent.classList.toggle('hidden', !isArabic);
                englishContent.classList.toggle('hidden', isArabic);

                translationText.textContent = isArabic ? 'Translate' : 'ترجمة';
                videoText.textContent = isArabic ? 'Video' : 'فيديو';
                loadingText.textContent = isArabic ? 'جاري تحميل الفيديو...' : 'Loading video...';
                errorText.textContent = isArabic ? 'خطأ في تحميل الفيديو' : 'Error loading video';
                document.title = isArabic ? 'دليل أساسيات المحاسبة - منصة أثر' : 'Comprehensive Guide: Accounting Fundamentals - Athr Platform';
                
                // Update quality selector
                qualitySelector.innerHTML = isArabic ? 
                    '<option value="auto">تلقائي</option><option value="720p">720p</option><option value="480p">480p</option><option value="360p">360p</option>' :
                    '<option value="auto">Auto</option><option value="720p">720p</option><option value="480p">480p</option><option value="360p">360p</option>';
            }

            // --- Video Player Logic ---
            function formatTime(seconds) {
                if (isNaN(seconds)) return '0:00';
                const minutes = Math.floor(seconds / 60);
                const secs = Math.floor(seconds % 60);
                return minutes + ':' + secs.toString().padStart(2, '0');
            }

            function showLoading(show) {
                videoLoading.style.display = show ? 'flex' : 'none';
            }

            function showError(show, message = '') {
                videoError.style.display = show ? 'block' : 'none';
                if (message) {
                    errorText.textContent = message;
                }
            }

            function togglePlay() {
                if (video.paused) {
                    const playPromise = video.play();
                    if (playPromise !== undefined) {
                        playPromise.catch(error => {
                            console.error('Error playing video:', error);
                            showError(true, isArabic ? 'خطأ في تشغيل الفيديو' : 'Error playing video');
                        });
                    }
                } else {
                    video.pause();
                }
            }

            function updateVolumeIcon() {
                const volume = video.volume;
                if (video.muted || volume === 0) {
                    volumeBtn.innerHTML = '<i class="fas fa-volume-mute"></i>';
                } else if (volume < 0.5) {
                    volumeBtn.innerHTML = '<i class="fas fa-volume-down"></i>';
                } else {
                    volumeBtn.innerHTML = '<i class="fas fa-volume-up"></i>';
                }
            }

            function updateBuffer() {
                if (video.buffered.length > 0) {
                    const bufferedEnd = video.buffered.end(video.buffered.length - 1);
                    const duration = video.duration;
                    if (duration > 0) {
                        const bufferedPercent = (bufferedEnd / duration) * 100;
                        bufferBar.style.width = bufferedPercent + '%';
                    }
                }
            }

            function toggleMute() {
                video.muted = !video.muted;
                updateVolumeIcon();
            }

            function toggleFullscreen() {
                if (!document.fullscreenElement) {
                    videoPlayer.requestFullscreen().catch(err => {
                        console.error('Error entering fullscreen:', err);
                    });
                } else {
                    document.exitFullscreen();
                }
            }

            // Retry video function
            window.retryVideo = function() {
                showError(false);
                showLoading(true);
                video.load();
            };

            // Video event listeners
            video.addEventListener('loadstart', () => {
                showLoading(true);
                showError(false);
            });

            video.addEventListener('loadedmetadata', () => {
                durationEl.textContent = formatTime(video.duration);
                videoPlayer.classList.add('paused');
                showLoading(false);
            });

            video.addEventListener('canplay', () => {
                showLoading(false);
                playPauseBtn.disabled = false;
            });

            video.addEventListener('waiting', () => {
                showLoading(true);
            });

            video.addEventListener('playing', () => {
                showLoading(false);
            });

            video.addEventListener('play', () => {
                playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
                videoPlayer.classList.remove('paused');
            });

            video.addEventListener('pause', () => {
                playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
                videoPlayer.classList.add('paused');
            });

            video.addEventListener('timeupdate', () => {
                const progress = (video.currentTime / video.duration) * 100;
                progressBar.style.width = progress + '%';
                currentTimeEl.textContent = formatTime(video.currentTime);
                updateBuffer();
            });

            video.addEventListener('progress', updateBuffer);

            video.addEventListener('error', (e) => {
                console.error('Video error:', e);
                showLoading(false);
                let errorMessage = isArabic ? 'خطأ في تحميل الفيديو' : 'Error loading video';
                
                switch(video.error.code) {
                    case 1:
                        errorMessage = isArabic ? 'تم إلغاء التحميل' : 'Video loading aborted';
                        break;
                    case 2:
                        errorMessage = isArabic ? 'خطأ في الشبكة' : 'Network error';
                        break;
                    case 3:
                        errorMessage = isArabic ? 'خطأ في فك تشفير الفيديو' : 'Video decode error';
                        break;
                    case 4:
                        errorMessage = isArabic ? 'تنسيق الفيديو غير مدعوم' : 'Video format not supported';
                        break;
                }
                
                showError(true, errorMessage);
            });

            video.addEventListener('stalled', () => {
                console.warn('Video stalled');
                showLoading(true);
            });

            // Control event listeners
            playPauseBtn.addEventListener('click', togglePlay);
            volumeBtn.addEventListener('click', toggleMute);
            fullscreenBtn.addEventListener('click', toggleFullscreen);

            volumeSlider.addEventListener('input', () => {
                video.volume = volumeSlider.value;
                video.muted = volumeSlider.value == 0;
                updateVolumeIcon();
            });

            progressBarContainer.addEventListener('click', (e) => {
                const rect = progressBarContainer.getBoundingClientRect();
                const clickX = e.clientX - rect.left;
                const width = rect.width;
                const newTime = (clickX / width) * video.duration;
                if (!isNaN(newTime)) {
                    video.currentTime = newTime;
                }
            });

            qualitySelector.addEventListener('change', (e) => {
                // Quality selector functionality would be implemented here
                console.log('Quality changed to:', e.target.value);
            });

            // Fullscreen event listeners
            document.addEventListener('fullscreenchange', () => {
                if (document.fullscreenElement) {
                    fullscreenBtn.innerHTML = '<i class="fas fa-compress"></i>';
                    fullscreenBtn.setAttribute('aria-label', 'Exit Fullscreen');
                } else {
                    fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i>';
                    fullscreenBtn.setAttribute('aria-label', 'Enter Fullscreen');
                }
            });

            // Modal controls
            videoButton.addEventListener('click', () => {
                videoModal.classList.add('visible');
                // Auto-load video when modal opens
                if (video.readyState === 0) {
                    video.load();
                }
            });

            videoCloseBtn.addEventListener('click', () => {
                videoModal.classList.remove('visible');
                video.pause();
                showLoading(false);
                showError(false);
            });

            videoModal.addEventListener('click', (e) => {
                if (e.target === videoModal) {
                    videoModal.classList.remove('visible');
                    video.pause();
                    showLoading(false);
                    showError(false);
                }
            });

            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                if (!videoModal.classList.contains('visible')) return;
                
                switch(e.code) {
                    case 'Space':
                        e.preventDefault();
                        togglePlay();
                        break;
                    case 'KeyM':
                        toggleMute();
                        break;
                    case 'KeyF':
                        toggleFullscreen();
                        break;
                    case 'ArrowLeft':
                        video.currentTime = Math.max(0, video.currentTime - 10);
                        break;
                    case 'ArrowRight':
                        video.currentTime = Math.min(video.duration, video.currentTime + 10);
                        break;
                    case 'ArrowUp':
                        e.preventDefault();
                        volumeSlider.value = Math.min(1, parseFloat(volumeSlider.value) + 0.1);
                        video.volume = volumeSlider.value;
                        updateVolumeIcon();
                        break;
                    case 'ArrowDown':
                        e.preventDefault();
                        volumeSlider.value = Math.max(0, parseFloat(volumeSlider.value) - 0.1);
                        video.volume = volumeSlider.value;
                        updateVolumeIcon();
                        break;
                    case 'Escape':
                        videoModal.classList.remove('visible');
                        video.pause();
                        break;
                }
            });

            // --- Quiz Logic ---
            function initializeQuiz() {
                const quizOptions = document.querySelectorAll('.quiz-option');
                
                quizOptions.forEach(option => {
                    option.addEventListener('click', function() {
                        const question = this.getAttribute('data-question');
                        const isCorrect = this.getAttribute('data-correct') === 'true';
                        const questionOptions = document.querySelectorAll(`[data-question="${question}"]`);
                        const resultDiv = document.getElementById(`result${question}`);
                        
                        // Disable all options for this question
                        questionOptions.forEach(opt => {
                            opt.classList.add('disabled');
                            opt.style.pointerEvents = 'none';
                        });
                        
                        // Show result
                        if (isCorrect) {
                            this.classList.add('correct');
                            if (resultDiv) {
                                resultDiv.className = 'quiz-result correct';
                                resultDiv.textContent = isArabic ? '✓ إجابة صحيحة! أحسنت.' : '✓ Correct! Well done.';
                            }
                        } else {
                            this.classList.add('wrong');
                            // Show correct answer
                            const correctOption = document.querySelector(`[data-question="${question}"][data-correct="true"]`);
                            if (correctOption) {
                                correctOption.classList.add('correct');
                            }
                            if (resultDiv) {
                                resultDiv.className = 'quiz-result wrong';
                                resultDiv.textContent = isArabic ? 
                                    '✗ إجابة خاطئة. الإجابة الصحيحة موضحة أعلاه.' : 
                                    '✗ Incorrect. The correct answer is highlighted above.';
                            }
                        }
                    });
                });
            }

            // Event listeners
            translationButton.addEventListener('click', () => applyLanguage(!isArabic));

            // Initialize
            applyLanguage(true);
            updateVolumeIcon();
            initializeQuiz();
            showLoading(false);
            showError(false);
            playPauseBtn.disabled = true; // Disable until video is ready
        });
    </script>
</body>
</html>
